<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="gbab-1"></a><span class="cm">/***************************************************************************/</span>
<a name="gbab-2"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-3"></a><span class="cm">/*  aftypes.h                                                              */</span>
<a name="gbab-4"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-5"></a><span class="cm">/*    Auto-fitter types (specification only).                              */</span>
<a name="gbab-6"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-7"></a><span class="cm">/*  Copyright 2003-2016 by                                                 */</span>
<a name="gbab-8"></a><span class="cm">/*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<a name="gbab-9"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-10"></a><span class="cm">/*  This file is part of the FreeType project, and may only be used,       */</span>
<a name="gbab-11"></a><span class="cm">/*  modified, and distributed under the terms of the FreeType project      */</span>
<a name="gbab-12"></a><span class="cm">/*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<a name="gbab-13"></a><span class="cm">/*  this file you indicate that you have read the license and              */</span>
<a name="gbab-14"></a><span class="cm">/*  understand and accept it fully.                                        */</span>
<a name="gbab-15"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-16"></a><span class="cm">/***************************************************************************/</span>
<a name="gbab-17"></a>
<a name="gbab-18"></a>
<a name="gbab-19"></a>  <span class="cm">/*************************************************************************</span>
<a name="gbab-20"></a><span class="cm">   *</span>
<a name="gbab-21"></a><span class="cm">   *  The auto-fitter is a complete rewrite of the old auto-hinter.</span>
<a name="gbab-22"></a><span class="cm">   *  Its main feature is the ability to differentiate between different</span>
<a name="gbab-23"></a><span class="cm">   *  writing systems and scripts in order to apply specific rules.</span>
<a name="gbab-24"></a><span class="cm">   *</span>
<a name="gbab-25"></a><span class="cm">   *  The code has also been compartmentalized into several entities that</span>
<a name="gbab-26"></a><span class="cm">   *  should make algorithmic experimentation easier than with the old</span>
<a name="gbab-27"></a><span class="cm">   *  code.</span>
<a name="gbab-28"></a><span class="cm">   *</span>
<a name="gbab-29"></a><span class="cm">   *************************************************************************/</span>
<a name="gbab-30"></a>
<a name="gbab-31"></a>
<a name="gbab-32"></a><span class="cp">#ifndef AFTYPES_H_</span>
<a name="gbab-33"></a><span class="cp">#define AFTYPES_H_</span>
<a name="gbab-34"></a>
<a name="gbab-35"></a><span class="cp">#include</span> <span class="cpf">&lt;ft2build.h&gt;</span><span class="cp"></span>
<a name="gbab-36"></a>
<a name="gbab-37"></a><span class="cp">#include</span> <span class="cpf">FT_FREETYPE_H</span><span class="cp"></span>
<a name="gbab-38"></a><span class="cp">#include</span> <span class="cpf">FT_OUTLINE_H</span><span class="cp"></span>
<a name="gbab-39"></a><span class="cp">#include</span> <span class="cpf">FT_INTERNAL_OBJECTS_H</span><span class="cp"></span>
<a name="gbab-40"></a><span class="cp">#include</span> <span class="cpf">FT_INTERNAL_DEBUG_H</span><span class="cp"></span>
<a name="gbab-41"></a>
<a name="gbab-42"></a><span class="cp">#include</span> <span class="cpf">&quot;afblue.h&quot;</span><span class="cp"></span>
<a name="gbab-43"></a>
<a name="gbab-44"></a><span class="cp">#ifdef FT_DEBUG_AUTOFIT</span>
<a name="gbab-45"></a><span class="cp">#include</span> <span class="cpf">FT_CONFIG_STANDARD_LIBRARY_H</span><span class="cp"></span>
<a name="gbab-46"></a><span class="cp">#endif</span>
<a name="gbab-47"></a>
<a name="gbab-48"></a>
<a name="gbab-49"></a><span class="n">FT_BEGIN_HEADER</span>
<a name="gbab-50"></a>
<a name="gbab-51"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-52"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-53"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-54"></a>  <span class="cm">/*****                    D E B U G G I N G                          *****/</span>
<a name="gbab-55"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-56"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-57"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-58"></a>
<a name="gbab-59"></a><span class="cp">#ifdef FT_DEBUG_AUTOFIT</span>
<a name="gbab-60"></a>
<a name="gbab-61"></a><span class="k">extern</span> <span class="kt">int</span>    <span class="n">_af_debug_disable_horz_hints</span><span class="p">;</span>
<a name="gbab-62"></a><span class="k">extern</span> <span class="kt">int</span>    <span class="n">_af_debug_disable_vert_hints</span><span class="p">;</span>
<a name="gbab-63"></a><span class="k">extern</span> <span class="kt">int</span>    <span class="n">_af_debug_disable_blue_hints</span><span class="p">;</span>
<a name="gbab-64"></a><span class="k">extern</span> <span class="kt">void</span><span class="o">*</span>  <span class="n">_af_debug_hints</span><span class="p">;</span>
<a name="gbab-65"></a>
<a name="gbab-66"></a><span class="cp">#endif </span><span class="cm">/* FT_DEBUG_AUTOFIT */</span><span class="cp"></span>
<a name="gbab-67"></a>
<a name="gbab-68"></a>
<a name="gbab-69"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-70"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-71"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-72"></a>  <span class="cm">/*****                 U T I L I T Y   S T U F F                     *****/</span>
<a name="gbab-73"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-74"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-75"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-76"></a>
<a name="gbab-77"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">AF_WidthRec_</span>
<a name="gbab-78"></a>  <span class="p">{</span>
<a name="gbab-79"></a>    <span class="n">FT_Pos</span>  <span class="n">org</span><span class="p">;</span>  <span class="cm">/* original position/width in font units              */</span>
<a name="gbab-80"></a>    <span class="n">FT_Pos</span>  <span class="n">cur</span><span class="p">;</span>  <span class="cm">/* current/scaled position/width in device sub-pixels */</span>
<a name="gbab-81"></a>    <span class="n">FT_Pos</span>  <span class="n">fit</span><span class="p">;</span>  <span class="cm">/* current/fitted position/width in device sub-pixels */</span>
<a name="gbab-82"></a>
<a name="gbab-83"></a>  <span class="p">}</span> <span class="n">AF_WidthRec</span><span class="p">,</span> <span class="o">*</span><span class="n">AF_Width</span><span class="p">;</span>
<a name="gbab-84"></a>
<a name="gbab-85"></a>
<a name="gbab-86"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
<a name="gbab-87"></a>  <span class="n">af_sort_pos</span><span class="p">(</span> <span class="n">FT_UInt</span>  <span class="n">count</span><span class="p">,</span>
<a name="gbab-88"></a>               <span class="n">FT_Pos</span><span class="o">*</span>  <span class="n">table</span> <span class="p">);</span>
<a name="gbab-89"></a>
<a name="gbab-90"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
<a name="gbab-91"></a>  <span class="n">af_sort_and_quantize_widths</span><span class="p">(</span> <span class="n">FT_UInt</span><span class="o">*</span>  <span class="n">count</span><span class="p">,</span>
<a name="gbab-92"></a>                               <span class="n">AF_Width</span>  <span class="n">widths</span><span class="p">,</span>
<a name="gbab-93"></a>                               <span class="n">FT_Pos</span>    <span class="n">threshold</span> <span class="p">);</span>
<a name="gbab-94"></a>
<a name="gbab-95"></a>
<a name="gbab-96"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-97"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-98"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-99"></a>  <span class="cm">/*****                   A N G L E   T Y P E S                       *****/</span>
<a name="gbab-100"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-101"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-102"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-103"></a>
<a name="gbab-104"></a>  <span class="cm">/*</span>
<a name="gbab-105"></a><span class="cm">   *  The auto-fitter doesn&#39;t need a very high angular accuracy;</span>
<a name="gbab-106"></a><span class="cm">   *  this allows us to speed up some computations considerably with a</span>
<a name="gbab-107"></a><span class="cm">   *  light Cordic algorithm (see afangles.c).</span>
<a name="gbab-108"></a><span class="cm">   */</span>
<a name="gbab-109"></a>
<a name="gbab-110"></a>  <span class="k">typedef</span> <span class="n">FT_Int</span>  <span class="n">AF_Angle</span><span class="p">;</span>
<a name="gbab-111"></a>
<a name="gbab-112"></a>
<a name="gbab-113"></a><span class="cp">#define AF_ANGLE_PI   256</span>
<a name="gbab-114"></a><span class="cp">#define AF_ANGLE_2PI  ( AF_ANGLE_PI * 2 )</span>
<a name="gbab-115"></a><span class="cp">#define AF_ANGLE_PI2  ( AF_ANGLE_PI / 2 )</span>
<a name="gbab-116"></a><span class="cp">#define AF_ANGLE_PI4  ( AF_ANGLE_PI / 4 )</span>
<a name="gbab-117"></a>
<a name="gbab-118"></a>
<a name="gbab-119"></a><span class="cp">#if 0</span><span class="c"></span>
<a name="gbab-120"></a><span class="c">  /*</span>
<a name="gbab-121"></a><span class="c">   *  compute the angle of a given 2-D vector</span>
<a name="gbab-122"></a><span class="c">   */</span>
<a name="gbab-123"></a><span class="c">  FT_LOCAL( AF_Angle )</span>
<a name="gbab-124"></a><span class="c">  af_angle_atan( FT_Pos  dx,</span>
<a name="gbab-125"></a><span class="c">                 FT_Pos  dy );</span>
<a name="gbab-126"></a>
<a name="gbab-127"></a>
<a name="gbab-128"></a><span class="c">  /*</span>
<a name="gbab-129"></a><span class="c">   *  compute `angle2 - angle1&#39;; the result is always within</span>
<a name="gbab-130"></a><span class="c">   *  the range [-AF_ANGLE_PI .. AF_ANGLE_PI - 1]</span>
<a name="gbab-131"></a><span class="c">   */</span>
<a name="gbab-132"></a><span class="c">  FT_LOCAL( AF_Angle )</span>
<a name="gbab-133"></a><span class="c">  af_angle_diff( AF_Angle  angle1,</span>
<a name="gbab-134"></a><span class="c">                 AF_Angle  angle2 );</span>
<a name="gbab-135"></a><span class="cp">#endif /* 0 */</span>
<a name="gbab-136"></a>
<a name="gbab-137"></a>
<a name="gbab-138"></a><span class="cp">#define AF_ANGLE_DIFF( result, angle1, angle2 ) \</span>
<a name="gbab-139"></a><span class="cp">  FT_BEGIN_STMNT                                \</span>
<a name="gbab-140"></a><span class="cp">    AF_Angle  _delta = (angle2) - (angle1);     \</span>
<a name="gbab-141"></a><span class="cp">                                                \</span>
<a name="gbab-142"></a><span class="cp">                                                \</span>
<a name="gbab-143"></a><span class="cp">    while ( _delta &lt;= -AF_ANGLE_PI )            \</span>
<a name="gbab-144"></a><span class="cp">      _delta += AF_ANGLE_2PI;                   \</span>
<a name="gbab-145"></a><span class="cp">                                                \</span>
<a name="gbab-146"></a><span class="cp">    while ( _delta &gt; AF_ANGLE_PI )              \</span>
<a name="gbab-147"></a><span class="cp">      _delta -= AF_ANGLE_2PI;                   \</span>
<a name="gbab-148"></a><span class="cp">                                                \</span>
<a name="gbab-149"></a><span class="cp">    result = _delta;                            \</span>
<a name="gbab-150"></a><span class="cp">  FT_END_STMNT</span>
<a name="gbab-151"></a>
<a name="gbab-152"></a>
<a name="gbab-153"></a>  <span class="cm">/*  opaque handle to glyph-specific hints -- see `afhints.h&#39; for more</span>
<a name="gbab-154"></a><span class="cm">   *  details</span>
<a name="gbab-155"></a><span class="cm">   */</span>
<a name="gbab-156"></a>  <span class="k">typedef</span> <span class="k">struct</span> <span class="n">AF_GlyphHintsRec_</span><span class="o">*</span>  <span class="n">AF_GlyphHints</span><span class="p">;</span>
<a name="gbab-157"></a>
<a name="gbab-158"></a>
<a name="gbab-159"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-160"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-161"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-162"></a>  <span class="cm">/*****                       S C A L E R S                           *****/</span>
<a name="gbab-163"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-164"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-165"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-166"></a>
<a name="gbab-167"></a>  <span class="cm">/*</span>
<a name="gbab-168"></a><span class="cm">   *  A scaler models the target pixel device that will receive the</span>
<a name="gbab-169"></a><span class="cm">   *  auto-hinted glyph image.</span>
<a name="gbab-170"></a><span class="cm">   */</span>
<a name="gbab-171"></a>
<a name="gbab-172"></a><span class="cp">#define AF_SCALER_FLAG_NO_HORIZONTAL  1U </span><span class="cm">/* disable horizontal hinting */</span><span class="cp"></span>
<a name="gbab-173"></a><span class="cp">#define AF_SCALER_FLAG_NO_VERTICAL    2U </span><span class="cm">/* disable vertical hinting   */</span><span class="cp"></span>
<a name="gbab-174"></a><span class="cp">#define AF_SCALER_FLAG_NO_ADVANCE     4U </span><span class="cm">/* disable advance hinting    */</span><span class="cp"></span>
<a name="gbab-175"></a><span class="cp">#define AF_SCALER_FLAG_NO_WARPER      8U </span><span class="cm">/* disable warper             */</span><span class="cp"></span>
<a name="gbab-176"></a>
<a name="gbab-177"></a>
<a name="gbab-178"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">AF_ScalerRec_</span>
<a name="gbab-179"></a>  <span class="p">{</span>
<a name="gbab-180"></a>    <span class="n">FT_Face</span>         <span class="n">face</span><span class="p">;</span>        <span class="cm">/* source font face                        */</span>
<a name="gbab-181"></a>    <span class="n">FT_Fixed</span>        <span class="n">x_scale</span><span class="p">;</span>     <span class="cm">/* from font units to 1/64th device pixels */</span>
<a name="gbab-182"></a>    <span class="n">FT_Fixed</span>        <span class="n">y_scale</span><span class="p">;</span>     <span class="cm">/* from font units to 1/64th device pixels */</span>
<a name="gbab-183"></a>    <span class="n">FT_Pos</span>          <span class="n">x_delta</span><span class="p">;</span>     <span class="cm">/* in 1/64th device pixels                 */</span>
<a name="gbab-184"></a>    <span class="n">FT_Pos</span>          <span class="n">y_delta</span><span class="p">;</span>     <span class="cm">/* in 1/64th device pixels                 */</span>
<a name="gbab-185"></a>    <span class="n">FT_Render_Mode</span>  <span class="n">render_mode</span><span class="p">;</span> <span class="cm">/* monochrome, anti-aliased, LCD, etc.     */</span>
<a name="gbab-186"></a>    <span class="n">FT_UInt32</span>       <span class="n">flags</span><span class="p">;</span>       <span class="cm">/* additional control flags, see above     */</span>
<a name="gbab-187"></a>
<a name="gbab-188"></a>  <span class="p">}</span> <span class="n">AF_ScalerRec</span><span class="p">,</span> <span class="o">*</span><span class="n">AF_Scaler</span><span class="p">;</span>
<a name="gbab-189"></a>
<a name="gbab-190"></a>
<a name="gbab-191"></a><span class="cp">#define AF_SCALER_EQUAL_SCALES( a, b )      \</span>
<a name="gbab-192"></a><span class="cp">          ( (a)-&gt;x_scale == (b)-&gt;x_scale &amp;&amp; \</span>
<a name="gbab-193"></a><span class="cp">            (a)-&gt;y_scale == (b)-&gt;y_scale &amp;&amp; \</span>
<a name="gbab-194"></a><span class="cp">            (a)-&gt;x_delta == (b)-&gt;x_delta &amp;&amp; \</span>
<a name="gbab-195"></a><span class="cp">            (a)-&gt;y_delta == (b)-&gt;y_delta )</span>
<a name="gbab-196"></a>
<a name="gbab-197"></a>
<a name="gbab-198"></a>  <span class="k">typedef</span> <span class="k">struct</span> <span class="n">AF_StyleMetricsRec_</span><span class="o">*</span>  <span class="n">AF_StyleMetrics</span><span class="p">;</span>
<a name="gbab-199"></a>
<a name="gbab-200"></a>  <span class="cm">/*  This function parses an FT_Face to compute global metrics for</span>
<a name="gbab-201"></a><span class="cm">   *  a specific style.</span>
<a name="gbab-202"></a><span class="cm">   */</span>
<a name="gbab-203"></a>  <span class="k">typedef</span> <span class="nf">FT_Error</span>
<a name="gbab-204"></a>  <span class="p">(</span><span class="o">*</span><span class="n">AF_WritingSystem_InitMetricsFunc</span><span class="p">)(</span> <span class="n">AF_StyleMetrics</span>  <span class="n">metrics</span><span class="p">,</span>
<a name="gbab-205"></a>                                <span class="n">FT_Face</span>           <span class="n">face</span> <span class="p">);</span>
<a name="gbab-206"></a>
<a name="gbab-207"></a>  <span class="k">typedef</span> <span class="nf">void</span>
<a name="gbab-208"></a>  <span class="p">(</span><span class="o">*</span><span class="n">AF_WritingSystem_ScaleMetricsFunc</span><span class="p">)(</span> <span class="n">AF_StyleMetrics</span>  <span class="n">metrics</span><span class="p">,</span>
<a name="gbab-209"></a>                                 <span class="n">AF_Scaler</span>         <span class="n">scaler</span> <span class="p">);</span>
<a name="gbab-210"></a>
<a name="gbab-211"></a>  <span class="k">typedef</span> <span class="nf">void</span>
<a name="gbab-212"></a>  <span class="p">(</span><span class="o">*</span><span class="n">AF_WritingSystem_DoneMetricsFunc</span><span class="p">)(</span> <span class="n">AF_StyleMetrics</span>  <span class="n">metrics</span> <span class="p">);</span>
<a name="gbab-213"></a>
<a name="gbab-214"></a>  <span class="k">typedef</span> <span class="nf">void</span>
<a name="gbab-215"></a>  <span class="p">(</span><span class="o">*</span><span class="n">AF_WritingSystem_GetStdWidthsFunc</span><span class="p">)(</span> <span class="n">AF_StyleMetrics</span>  <span class="n">metrics</span><span class="p">,</span>
<a name="gbab-216"></a>                                        <span class="n">FT_Pos</span><span class="o">*</span>          <span class="n">stdHW</span><span class="p">,</span>
<a name="gbab-217"></a>                                        <span class="n">FT_Pos</span><span class="o">*</span>          <span class="n">stdVW</span> <span class="p">);</span>
<a name="gbab-218"></a>
<a name="gbab-219"></a>
<a name="gbab-220"></a>  <span class="k">typedef</span> <span class="nf">FT_Error</span>
<a name="gbab-221"></a>  <span class="p">(</span><span class="o">*</span><span class="n">AF_WritingSystem_InitHintsFunc</span><span class="p">)(</span> <span class="n">AF_GlyphHints</span>    <span class="n">hints</span><span class="p">,</span>
<a name="gbab-222"></a>                                     <span class="n">AF_StyleMetrics</span>  <span class="n">metrics</span> <span class="p">);</span>
<a name="gbab-223"></a>
<a name="gbab-224"></a>  <span class="k">typedef</span> <span class="nf">void</span>
<a name="gbab-225"></a>  <span class="p">(</span><span class="o">*</span><span class="n">AF_WritingSystem_ApplyHintsFunc</span><span class="p">)(</span> <span class="n">FT_UInt</span>          <span class="n">glyph_index</span><span class="p">,</span>
<a name="gbab-226"></a>                                      <span class="n">AF_GlyphHints</span>    <span class="n">hints</span><span class="p">,</span>
<a name="gbab-227"></a>                               <span class="n">FT_Outline</span><span class="o">*</span>       <span class="n">outline</span><span class="p">,</span>
<a name="gbab-228"></a>                                      <span class="n">AF_StyleMetrics</span>  <span class="n">metrics</span> <span class="p">);</span>
<a name="gbab-229"></a>
<a name="gbab-230"></a>
<a name="gbab-231"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-232"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-233"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-234"></a>  <span class="cm">/*****                W R I T I N G   S Y S T E M S                  *****/</span>
<a name="gbab-235"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-236"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-237"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-238"></a>
<a name="gbab-239"></a>  <span class="cm">/*</span>
<a name="gbab-240"></a><span class="cm">   *  For the auto-hinter, a writing system consists of multiple scripts that</span>
<a name="gbab-241"></a><span class="cm">   *  can be handled similarly *in a typographical way*; the relationship is</span>
<a name="gbab-242"></a><span class="cm">   *  not based on history.  For example, both the Greek and the unrelated</span>
<a name="gbab-243"></a><span class="cm">   *  Armenian scripts share the same features like ascender, descender,</span>
<a name="gbab-244"></a><span class="cm">   *  x-height, etc.  Essentially, a writing system is covered by a</span>
<a name="gbab-245"></a><span class="cm">   *  submodule of the auto-fitter; it contains</span>
<a name="gbab-246"></a><span class="cm">   *</span>
<a name="gbab-247"></a><span class="cm">   *  - a specific global analyzer that computes global metrics specific to</span>
<a name="gbab-248"></a><span class="cm">   *    the script (based on script-specific characters to identify ascender</span>
<a name="gbab-249"></a><span class="cm">   *    height, x-height, etc.),</span>
<a name="gbab-250"></a><span class="cm">   *</span>
<a name="gbab-251"></a><span class="cm">   *  - a specific glyph analyzer that computes segments and edges for each</span>
<a name="gbab-252"></a><span class="cm">   *    glyph covered by the script,</span>
<a name="gbab-253"></a><span class="cm">   *</span>
<a name="gbab-254"></a><span class="cm">   *  - a specific grid-fitting algorithm that distorts the scaled glyph</span>
<a name="gbab-255"></a><span class="cm">   *    outline according to the results of the glyph analyzer.</span>
<a name="gbab-256"></a><span class="cm">   */</span>
<a name="gbab-257"></a>
<a name="gbab-258"></a><span class="cp">#define AFWRTSYS_H_  </span><span class="cm">/* don&#39;t load header files */</span><span class="cp"></span>
<a name="gbab-259"></a><span class="cp">#undef  WRITING_SYSTEM</span>
<a name="gbab-260"></a><span class="cp">#define WRITING_SYSTEM( ws, WS )    \</span>
<a name="gbab-261"></a><span class="cp">          AF_WRITING_SYSTEM_ ## WS,</span>
<a name="gbab-262"></a>
<a name="gbab-263"></a>  <span class="cm">/* The list of known writing systems. */</span>
<a name="gbab-264"></a>  <span class="k">typedef</span> <span class="k">enum</span>  <span class="n">AF_WritingSystem_</span>
<a name="gbab-265"></a>  <span class="p">{</span>
<a name="gbab-266"></a>
<a name="gbab-267"></a><span class="cp">#include</span> <span class="cpf">&quot;afwrtsys.h&quot;</span><span class="cp"></span>
<a name="gbab-268"></a>
<a name="gbab-269"></a>    <span class="n">AF_WRITING_SYSTEM_MAX</span>   <span class="cm">/* do not remove */</span>
<a name="gbab-270"></a>
<a name="gbab-271"></a>  <span class="p">}</span> <span class="n">AF_WritingSystem</span><span class="p">;</span>
<a name="gbab-272"></a>
<a name="gbab-273"></a><span class="cp">#undef  AFWRTSYS_H_</span>
<a name="gbab-274"></a>
<a name="gbab-275"></a>
<a name="gbab-276"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">AF_WritingSystemClassRec_</span>
<a name="gbab-277"></a>  <span class="p">{</span>
<a name="gbab-278"></a>    <span class="n">AF_WritingSystem</span>  <span class="n">writing_system</span><span class="p">;</span>
<a name="gbab-279"></a>
<a name="gbab-280"></a>    <span class="n">FT_Offset</span>                          <span class="n">style_metrics_size</span><span class="p">;</span>
<a name="gbab-281"></a>    <span class="n">AF_WritingSystem_InitMetricsFunc</span>   <span class="n">style_metrics_init</span><span class="p">;</span>
<a name="gbab-282"></a>    <span class="n">AF_WritingSystem_ScaleMetricsFunc</span>  <span class="n">style_metrics_scale</span><span class="p">;</span>
<a name="gbab-283"></a>    <span class="n">AF_WritingSystem_DoneMetricsFunc</span>   <span class="n">style_metrics_done</span><span class="p">;</span>
<a name="gbab-284"></a>    <span class="n">AF_WritingSystem_GetStdWidthsFunc</span>  <span class="n">style_metrics_getstdw</span><span class="p">;</span>
<a name="gbab-285"></a>
<a name="gbab-286"></a>    <span class="n">AF_WritingSystem_InitHintsFunc</span>     <span class="n">style_hints_init</span><span class="p">;</span>
<a name="gbab-287"></a>    <span class="n">AF_WritingSystem_ApplyHintsFunc</span>    <span class="n">style_hints_apply</span><span class="p">;</span>
<a name="gbab-288"></a>
<a name="gbab-289"></a>  <span class="p">}</span> <span class="n">AF_WritingSystemClassRec</span><span class="p">;</span>
<a name="gbab-290"></a>
<a name="gbab-291"></a>  <span class="k">typedef</span> <span class="k">const</span> <span class="n">AF_WritingSystemClassRec</span><span class="o">*</span>  <span class="n">AF_WritingSystemClass</span><span class="p">;</span>
<a name="gbab-292"></a>
<a name="gbab-293"></a>
<a name="gbab-294"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-295"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-296"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-297"></a>  <span class="cm">/*****                        S C R I P T S                          *****/</span>
<a name="gbab-298"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-299"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-300"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-301"></a>
<a name="gbab-302"></a>  <span class="cm">/*</span>
<a name="gbab-303"></a><span class="cm">   *  Each script is associated with two sets of Unicode ranges to test</span>
<a name="gbab-304"></a><span class="cm">   *  whether the font face supports the script, and which non-base</span>
<a name="gbab-305"></a><span class="cm">   *  characters the script contains.</span>
<a name="gbab-306"></a><span class="cm">   *</span>
<a name="gbab-307"></a><span class="cm">   *  We use four-letter script tags from the OpenType specification,</span>
<a name="gbab-308"></a><span class="cm">   *  extended by `NONE&#39;, which indicates `no script&#39;.</span>
<a name="gbab-309"></a><span class="cm">   */</span>
<a name="gbab-310"></a>
<a name="gbab-311"></a><span class="cp">#undef  SCRIPT</span>
<a name="gbab-312"></a><span class="cp">#define SCRIPT( s, S, d, h, H, ss ) \</span>
<a name="gbab-313"></a><span class="cp">          AF_SCRIPT_ ## S,</span>
<a name="gbab-314"></a>
<a name="gbab-315"></a>  <span class="cm">/* The list of known scripts. */</span>
<a name="gbab-316"></a>  <span class="k">typedef</span> <span class="k">enum</span>  <span class="n">AF_Script_</span>
<a name="gbab-317"></a>  <span class="p">{</span>
<a name="gbab-318"></a>
<a name="gbab-319"></a><span class="cp">#include</span> <span class="cpf">&quot;afscript.h&quot;</span><span class="cp"></span>
<a name="gbab-320"></a>
<a name="gbab-321"></a>    <span class="n">AF_SCRIPT_MAX</span>   <span class="cm">/* do not remove */</span>
<a name="gbab-322"></a>
<a name="gbab-323"></a>  <span class="p">}</span> <span class="n">AF_Script</span><span class="p">;</span>
<a name="gbab-324"></a>
<a name="gbab-325"></a>
<a name="gbab-326"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">AF_Script_UniRangeRec_</span>
<a name="gbab-327"></a>  <span class="p">{</span>
<a name="gbab-328"></a>    <span class="n">FT_UInt32</span>  <span class="n">first</span><span class="p">;</span>
<a name="gbab-329"></a>    <span class="n">FT_UInt32</span>  <span class="n">last</span><span class="p">;</span>
<a name="gbab-330"></a>
<a name="gbab-331"></a>  <span class="p">}</span> <span class="n">AF_Script_UniRangeRec</span><span class="p">;</span>
<a name="gbab-332"></a>
<a name="gbab-333"></a><span class="cp">#define AF_UNIRANGE_REC( a, b ) { (FT_UInt32)(a), (FT_UInt32)(b) }</span>
<a name="gbab-334"></a>
<a name="gbab-335"></a>  <span class="k">typedef</span> <span class="k">const</span> <span class="n">AF_Script_UniRangeRec</span>  <span class="o">*</span><span class="n">AF_Script_UniRange</span><span class="p">;</span>
<a name="gbab-336"></a>
<a name="gbab-337"></a>
<a name="gbab-338"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">AF_ScriptClassRec_</span>
<a name="gbab-339"></a>  <span class="p">{</span>
<a name="gbab-340"></a>    <span class="n">AF_Script</span>           <span class="n">script</span><span class="p">;</span>
<a name="gbab-341"></a>
<a name="gbab-342"></a>    <span class="cm">/* last element in the ranges must be { 0, 0 } */</span>
<a name="gbab-343"></a>    <span class="n">AF_Script_UniRange</span>  <span class="n">script_uni_ranges</span><span class="p">;</span>
<a name="gbab-344"></a>    <span class="n">AF_Script_UniRange</span>  <span class="n">script_uni_nonbase_ranges</span><span class="p">;</span>
<a name="gbab-345"></a>
<a name="gbab-346"></a>    <span class="n">FT_Bool</span>  <span class="n">top_to_bottom_hinting</span><span class="p">;</span>
<a name="gbab-347"></a>
<a name="gbab-348"></a>    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span>  <span class="n">standard_charstring</span><span class="p">;</span>      <span class="cm">/* for default width and height */</span>
<a name="gbab-349"></a>
<a name="gbab-350"></a>  <span class="p">}</span> <span class="n">AF_ScriptClassRec</span><span class="p">;</span>
<a name="gbab-351"></a>
<a name="gbab-352"></a>  <span class="k">typedef</span> <span class="k">const</span> <span class="n">AF_ScriptClassRec</span><span class="o">*</span>  <span class="n">AF_ScriptClass</span><span class="p">;</span>
<a name="gbab-353"></a>
<a name="gbab-354"></a>
<a name="gbab-355"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-356"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-357"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-358"></a>  <span class="cm">/*****                      C O V E R A G E S                        *****/</span>
<a name="gbab-359"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-360"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-361"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-362"></a>
<a name="gbab-363"></a>  <span class="cm">/*</span>
<a name="gbab-364"></a><span class="cm">   *  Usually, a font contains more glyphs than can be addressed by its</span>
<a name="gbab-365"></a><span class="cm">   *  character map.</span>
<a name="gbab-366"></a><span class="cm">   *</span>
<a name="gbab-367"></a><span class="cm">   *  In the PostScript font world, encoding vectors specific to a given</span>
<a name="gbab-368"></a><span class="cm">   *  task are used to select such glyphs, and these glyphs can be often</span>
<a name="gbab-369"></a><span class="cm">   *  recognized by having a suffix in its glyph names.  For example, a</span>
<a name="gbab-370"></a><span class="cm">   *  superscript glyph `A&#39; might be called `A.sup&#39;.  Unfortunately, this</span>
<a name="gbab-371"></a><span class="cm">   *  naming scheme is not standardized and thus unusable for us.</span>
<a name="gbab-372"></a><span class="cm">   *</span>
<a name="gbab-373"></a><span class="cm">   *  In the OpenType world, a better solution was invented, namely</span>
<a name="gbab-374"></a><span class="cm">   *  `features&#39;, which cleanly separate a character&#39;s input encoding from</span>
<a name="gbab-375"></a><span class="cm">   *  the corresponding glyph&#39;s appearance, and which don&#39;t use glyph names</span>
<a name="gbab-376"></a><span class="cm">   *  at all.  For our purposes, and slightly generalized, an OpenType</span>
<a name="gbab-377"></a><span class="cm">   *  feature is a name of a mapping that maps character codes to</span>
<a name="gbab-378"></a><span class="cm">   *  non-standard glyph indices (features get used for other things also).</span>
<a name="gbab-379"></a><span class="cm">   *  For example, the `sups&#39; feature provides superscript glyphs, thus</span>
<a name="gbab-380"></a><span class="cm">   *  mapping character codes like `A&#39; or `B&#39; to superscript glyph</span>
<a name="gbab-381"></a><span class="cm">   *  representation forms.  How this mapping happens is completely</span>
<a name="gbab-382"></a><span class="cm">   *  uninteresting to us.</span>
<a name="gbab-383"></a><span class="cm">   *</span>
<a name="gbab-384"></a><span class="cm">   *  For the auto-hinter, a `coverage&#39; represents all glyphs of an OpenType</span>
<a name="gbab-385"></a><span class="cm">   *  feature collected in a set (as listed below) that can be hinted</span>
<a name="gbab-386"></a><span class="cm">   *  together.  To continue the above example, superscript glyphs must not</span>
<a name="gbab-387"></a><span class="cm">   *  be hinted together with normal glyphs because the blue zones</span>
<a name="gbab-388"></a><span class="cm">   *  completely differ.</span>
<a name="gbab-389"></a><span class="cm">   *</span>
<a name="gbab-390"></a><span class="cm">   *  Note that FreeType itself doesn&#39;t compute coverages; it only provides</span>
<a name="gbab-391"></a><span class="cm">   *  the glyphs addressable by the default Unicode character map.  Instead,</span>
<a name="gbab-392"></a><span class="cm">   *  we use the HarfBuzz library (if available), which has many functions</span>
<a name="gbab-393"></a><span class="cm">   *  exactly for this purpose.</span>
<a name="gbab-394"></a><span class="cm">   *</span>
<a name="gbab-395"></a><span class="cm">   *  AF_COVERAGE_DEFAULT is special: It should cover everything that isn&#39;t</span>
<a name="gbab-396"></a><span class="cm">   *  listed separately (including the glyphs addressable by the character</span>
<a name="gbab-397"></a><span class="cm">   *  map).  In case HarfBuzz isn&#39;t available, it exactly covers the glyphs</span>
<a name="gbab-398"></a><span class="cm">   *  addressable by the character map.</span>
<a name="gbab-399"></a><span class="cm">   *</span>
<a name="gbab-400"></a><span class="cm">   */</span>
<a name="gbab-401"></a>
<a name="gbab-402"></a><span class="cp">#undef  COVERAGE</span>
<a name="gbab-403"></a><span class="cp">#define COVERAGE( name, NAME, description, \</span>
<a name="gbab-404"></a><span class="cp">                  tag1, tag2, tag3, tag4 ) \</span>
<a name="gbab-405"></a><span class="cp">          AF_COVERAGE_ ## NAME,</span>
<a name="gbab-406"></a>
<a name="gbab-407"></a>
<a name="gbab-408"></a>  <span class="k">typedef</span> <span class="k">enum</span>  <span class="n">AF_Coverage_</span>
<a name="gbab-409"></a>  <span class="p">{</span>
<a name="gbab-410"></a><span class="cp">#include</span> <span class="cpf">&quot;afcover.h&quot;</span><span class="cp"></span>
<a name="gbab-411"></a>
<a name="gbab-412"></a>    <span class="n">AF_COVERAGE_DEFAULT</span>
<a name="gbab-413"></a>
<a name="gbab-414"></a>  <span class="p">}</span> <span class="n">AF_Coverage</span><span class="p">;</span>
<a name="gbab-415"></a>
<a name="gbab-416"></a>
<a name="gbab-417"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-418"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-419"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-420"></a>  <span class="cm">/*****                         S T Y L E S                           *****/</span>
<a name="gbab-421"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-422"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-423"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-424"></a>
<a name="gbab-425"></a>  <span class="cm">/*</span>
<a name="gbab-426"></a><span class="cm">   *  The topmost structure for modelling the auto-hinter glyph input data</span>
<a name="gbab-427"></a><span class="cm">   *  is a `style class&#39;, grouping everything together.</span>
<a name="gbab-428"></a><span class="cm">   */</span>
<a name="gbab-429"></a>
<a name="gbab-430"></a><span class="cp">#undef  STYLE</span>
<a name="gbab-431"></a><span class="cp">#define STYLE( s, S, d, ws, sc, ss, c ) \</span>
<a name="gbab-432"></a><span class="cp">          AF_STYLE_ ## S,</span>
<a name="gbab-433"></a>
<a name="gbab-434"></a>  <span class="cm">/* The list of known styles. */</span>
<a name="gbab-435"></a>  <span class="k">typedef</span> <span class="k">enum</span>  <span class="n">AF_Style_</span>
<a name="gbab-436"></a>  <span class="p">{</span>
<a name="gbab-437"></a>
<a name="gbab-438"></a><span class="cp">#include</span> <span class="cpf">&quot;afstyles.h&quot;</span><span class="cp"></span>
<a name="gbab-439"></a>
<a name="gbab-440"></a>    <span class="n">AF_STYLE_MAX</span>   <span class="cm">/* do not remove */</span>
<a name="gbab-441"></a>
<a name="gbab-442"></a>  <span class="p">}</span> <span class="n">AF_Style</span><span class="p">;</span>
<a name="gbab-443"></a>
<a name="gbab-444"></a>
<a name="gbab-445"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">AF_StyleClassRec_</span>
<a name="gbab-446"></a>  <span class="p">{</span>
<a name="gbab-447"></a>    <span class="n">AF_Style</span>  <span class="n">style</span><span class="p">;</span>
<a name="gbab-448"></a>
<a name="gbab-449"></a>    <span class="n">AF_WritingSystem</span>   <span class="n">writing_system</span><span class="p">;</span>
<a name="gbab-450"></a>    <span class="n">AF_Script</span>          <span class="n">script</span><span class="p">;</span>
<a name="gbab-451"></a>    <span class="n">AF_Blue_Stringset</span>  <span class="n">blue_stringset</span><span class="p">;</span>
<a name="gbab-452"></a>    <span class="n">AF_Coverage</span>        <span class="n">coverage</span><span class="p">;</span>
<a name="gbab-453"></a>
<a name="gbab-454"></a>  <span class="p">}</span> <span class="n">AF_StyleClassRec</span><span class="p">;</span>
<a name="gbab-455"></a>
<a name="gbab-456"></a>  <span class="k">typedef</span> <span class="k">const</span> <span class="n">AF_StyleClassRec</span><span class="o">*</span>  <span class="n">AF_StyleClass</span><span class="p">;</span>
<a name="gbab-457"></a>
<a name="gbab-458"></a>
<a name="gbab-459"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-460"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-461"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-462"></a>  <span class="cm">/*****                   S T Y L E   M E T R I C S                   *****/</span>
<a name="gbab-463"></a>  <span class="cm">/*****                                                               *****/</span>
<a name="gbab-464"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-465"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-466"></a>
<a name="gbab-467"></a>  <span class="k">typedef</span> <span class="k">struct</span> <span class="n">AF_FaceGlobalsRec_</span><span class="o">*</span>  <span class="n">AF_FaceGlobals</span><span class="p">;</span>
<a name="gbab-468"></a>
<a name="gbab-469"></a>  <span class="cm">/* This is the main structure that combines everything.  Autofit modules */</span>
<a name="gbab-470"></a>  <span class="cm">/* specific to writing systems derive their structures from it, for      */</span>
<a name="gbab-471"></a>  <span class="cm">/* example `AF_LatinMetrics&#39;.                                            */</span>
<a name="gbab-472"></a>
<a name="gbab-473"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">AF_StyleMetricsRec_</span>
<a name="gbab-474"></a>  <span class="p">{</span>
<a name="gbab-475"></a>    <span class="n">AF_StyleClass</span>   <span class="n">style_class</span><span class="p">;</span>
<a name="gbab-476"></a>    <span class="n">AF_ScalerRec</span>    <span class="n">scaler</span><span class="p">;</span>
<a name="gbab-477"></a>    <span class="n">FT_Bool</span>         <span class="n">digits_have_same_width</span><span class="p">;</span>
<a name="gbab-478"></a>
<a name="gbab-479"></a>    <span class="n">AF_FaceGlobals</span>  <span class="n">globals</span><span class="p">;</span>    <span class="cm">/* to access properties */</span>
<a name="gbab-480"></a>
<a name="gbab-481"></a>  <span class="p">}</span> <span class="n">AF_StyleMetricsRec</span><span class="p">;</span>
<a name="gbab-482"></a>
<a name="gbab-483"></a>
<a name="gbab-484"></a><span class="cp">#define AF_HINTING_BOTTOM_TO_TOP  0</span>
<a name="gbab-485"></a><span class="cp">#define AF_HINTING_TOP_TO_BOTTOM  1</span>
<a name="gbab-486"></a>
<a name="gbab-487"></a>
<a name="gbab-488"></a>  <span class="cm">/* Declare and define vtables for classes */</span>
<a name="gbab-489"></a><span class="cp">#ifndef FT_CONFIG_OPTION_PIC</span>
<a name="gbab-490"></a>
<a name="gbab-491"></a><span class="cp">#define AF_DECLARE_WRITING_SYSTEM_CLASS( writing_system_class ) \</span>
<a name="gbab-492"></a><span class="cp">  FT_CALLBACK_TABLE const AF_WritingSystemClassRec              \</span>
<a name="gbab-493"></a><span class="cp">  writing_system_class;</span>
<a name="gbab-494"></a>
<a name="gbab-495"></a><span class="cp">#define AF_DEFINE_WRITING_SYSTEM_CLASS(                  \</span>
<a name="gbab-496"></a><span class="cp">          writing_system_class,                          \</span>
<a name="gbab-497"></a><span class="cp">          system,                                        \</span>
<a name="gbab-498"></a><span class="cp">          m_size,                                        \</span>
<a name="gbab-499"></a><span class="cp">          m_init,                                        \</span>
<a name="gbab-500"></a><span class="cp">          m_scale,                                       \</span>
<a name="gbab-501"></a><span class="cp">          m_done,                                        \</span>
<a name="gbab-502"></a><span class="cp">          m_stdw,                                        \</span>
<a name="gbab-503"></a><span class="cp">          h_init,                                        \</span>
<a name="gbab-504"></a><span class="cp">          h_apply )                                      \</span>
<a name="gbab-505"></a><span class="cp">  FT_CALLBACK_TABLE_DEF                                  \</span>
<a name="gbab-506"></a><span class="cp">  const AF_WritingSystemClassRec  writing_system_class = \</span>
<a name="gbab-507"></a><span class="cp">  {                                                      \</span>
<a name="gbab-508"></a><span class="cp">    system,                                              \</span>
<a name="gbab-509"></a><span class="cp">                                                         \</span>
<a name="gbab-510"></a><span class="cp">    m_size,                                              \</span>
<a name="gbab-511"></a><span class="cp">                                                         \</span>
<a name="gbab-512"></a><span class="cp">    m_init,                                              \</span>
<a name="gbab-513"></a><span class="cp">    m_scale,                                             \</span>
<a name="gbab-514"></a><span class="cp">    m_done,                                              \</span>
<a name="gbab-515"></a><span class="cp">    m_stdw,                                              \</span>
<a name="gbab-516"></a><span class="cp">                                                         \</span>
<a name="gbab-517"></a><span class="cp">    h_init,                                              \</span>
<a name="gbab-518"></a><span class="cp">    h_apply                                              \</span>
<a name="gbab-519"></a><span class="cp">  };</span>
<a name="gbab-520"></a>
<a name="gbab-521"></a>
<a name="gbab-522"></a><span class="cp">#define AF_DECLARE_SCRIPT_CLASS( script_class ) \</span>
<a name="gbab-523"></a><span class="cp">  FT_CALLBACK_TABLE const AF_ScriptClassRec     \</span>
<a name="gbab-524"></a><span class="cp">  script_class;</span>
<a name="gbab-525"></a>
<a name="gbab-526"></a><span class="cp">#define AF_DEFINE_SCRIPT_CLASS(           \</span>
<a name="gbab-527"></a><span class="cp">          script_class,                   \</span>
<a name="gbab-528"></a><span class="cp">          script,                         \</span>
<a name="gbab-529"></a><span class="cp">          ranges,                         \</span>
<a name="gbab-530"></a><span class="cp">          nonbase_ranges,                 \</span>
<a name="gbab-531"></a><span class="cp">          top_to_bottom,                  \</span>
<a name="gbab-532"></a><span class="cp">          std_charstring )                \</span>
<a name="gbab-533"></a><span class="cp">  FT_CALLBACK_TABLE_DEF                   \</span>
<a name="gbab-534"></a><span class="cp">  const AF_ScriptClassRec  script_class = \</span>
<a name="gbab-535"></a><span class="cp">  {                                                                        \</span>
<a name="gbab-536"></a><span class="cp">    script,                               \</span>
<a name="gbab-537"></a><span class="cp">    ranges,                                                                \</span>
<a name="gbab-538"></a><span class="cp">    nonbase_ranges,                       \</span>
<a name="gbab-539"></a><span class="cp">    top_to_bottom,                        \</span>
<a name="gbab-540"></a><span class="cp">    std_charstring,                       \</span>
<a name="gbab-541"></a><span class="cp">  };</span>
<a name="gbab-542"></a>
<a name="gbab-543"></a>
<a name="gbab-544"></a><span class="cp">#define AF_DECLARE_STYLE_CLASS( style_class ) \</span>
<a name="gbab-545"></a><span class="cp">  FT_CALLBACK_TABLE const AF_StyleClassRec    \</span>
<a name="gbab-546"></a><span class="cp">  style_class;</span>
<a name="gbab-547"></a>
<a name="gbab-548"></a><span class="cp">#define AF_DEFINE_STYLE_CLASS(          \</span>
<a name="gbab-549"></a><span class="cp">          style_class,                  \</span>
<a name="gbab-550"></a><span class="cp">          style,                        \</span>
<a name="gbab-551"></a><span class="cp">          writing_system,               \</span>
<a name="gbab-552"></a><span class="cp">          script,                       \</span>
<a name="gbab-553"></a><span class="cp">          blue_stringset,               \</span>
<a name="gbab-554"></a><span class="cp">          coverage )                    \</span>
<a name="gbab-555"></a><span class="cp">  FT_CALLBACK_TABLE_DEF                 \</span>
<a name="gbab-556"></a><span class="cp">  const AF_StyleClassRec  style_class = \</span>
<a name="gbab-557"></a><span class="cp">  {                                     \</span>
<a name="gbab-558"></a><span class="cp">    style,                              \</span>
<a name="gbab-559"></a><span class="cp">    writing_system,                     \</span>
<a name="gbab-560"></a><span class="cp">    script,                             \</span>
<a name="gbab-561"></a><span class="cp">    blue_stringset,                     \</span>
<a name="gbab-562"></a><span class="cp">    coverage                            \</span>
<a name="gbab-563"></a><span class="cp">  };</span>
<a name="gbab-564"></a>
<a name="gbab-565"></a><span class="cp">#else </span><span class="cm">/* FT_CONFIG_OPTION_PIC */</span><span class="cp"></span>
<a name="gbab-566"></a>
<a name="gbab-567"></a><span class="cp">#define AF_DECLARE_WRITING_SYSTEM_CLASS( writing_system_class )            \</span>
<a name="gbab-568"></a><span class="cp">  FT_LOCAL( void )                                                         \</span>
<a name="gbab-569"></a><span class="cp">  FT_Init_Class_ ## writing_system_class( AF_WritingSystemClassRec*  ac );</span>
<a name="gbab-570"></a>
<a name="gbab-571"></a><span class="cp">#define AF_DEFINE_WRITING_SYSTEM_CLASS(                                   \</span>
<a name="gbab-572"></a><span class="cp">          writing_system_class,                                           \</span>
<a name="gbab-573"></a><span class="cp">          system,                                                         \</span>
<a name="gbab-574"></a><span class="cp">          m_size,                                                         \</span>
<a name="gbab-575"></a><span class="cp">          m_init,                                                         \</span>
<a name="gbab-576"></a><span class="cp">          m_scale,                                                        \</span>
<a name="gbab-577"></a><span class="cp">          m_done,                                                         \</span>
<a name="gbab-578"></a><span class="cp">          h_init,                                                         \</span>
<a name="gbab-579"></a><span class="cp">          h_apply )                                                       \</span>
<a name="gbab-580"></a><span class="cp">  FT_LOCAL_DEF( void )                                                    \</span>
<a name="gbab-581"></a><span class="cp">  FT_Init_Class_ ## writing_system_class( AF_WritingSystemClassRec*  ac ) \</span>
<a name="gbab-582"></a><span class="cp">  {                                                                       \</span>
<a name="gbab-583"></a><span class="cp">    ac-&gt;writing_system        = system;                                   \</span>
<a name="gbab-584"></a><span class="cp">                                                                          \</span>
<a name="gbab-585"></a><span class="cp">    ac-&gt;style_metrics_size    = m_size;                                   \</span>
<a name="gbab-586"></a><span class="cp">                                                                          \</span>
<a name="gbab-587"></a><span class="cp">    ac-&gt;style_metrics_init    = m_init;                                   \</span>
<a name="gbab-588"></a><span class="cp">    ac-&gt;style_metrics_scale   = m_scale;                                  \</span>
<a name="gbab-589"></a><span class="cp">    ac-&gt;style_metrics_done    = m_done;                                   \</span>
<a name="gbab-590"></a><span class="cp">    ac-&gt;style_metrics_getstdw = m_stdw;                                   \</span>
<a name="gbab-591"></a><span class="cp">                                                                          \</span>
<a name="gbab-592"></a><span class="cp">    ac-&gt;style_hints_init      = h_init;                                   \</span>
<a name="gbab-593"></a><span class="cp">    ac-&gt;style_hints_apply     = h_apply;                                  \</span>
<a name="gbab-594"></a><span class="cp">  }</span>
<a name="gbab-595"></a>
<a name="gbab-596"></a>
<a name="gbab-597"></a><span class="cp">#define AF_DECLARE_SCRIPT_CLASS( script_class )             \</span>
<a name="gbab-598"></a><span class="cp">  FT_LOCAL( void )                                          \</span>
<a name="gbab-599"></a><span class="cp">  FT_Init_Class_ ## script_class( AF_ScriptClassRec*  ac );</span>
<a name="gbab-600"></a>
<a name="gbab-601"></a><span class="cp">#define AF_DEFINE_SCRIPT_CLASS(                            \</span>
<a name="gbab-602"></a><span class="cp">          script_class,                                    \</span>
<a name="gbab-603"></a><span class="cp">          script_,                                         \</span>
<a name="gbab-604"></a><span class="cp">          ranges,                                          \</span>
<a name="gbab-605"></a><span class="cp">          nonbase_ranges,                                  \</span>
<a name="gbab-606"></a><span class="cp">          top_to_bottom,                                   \</span>
<a name="gbab-607"></a><span class="cp">          std_charstring )                                 \</span>
<a name="gbab-608"></a><span class="cp">  FT_LOCAL_DEF( void )                                                     \</span>
<a name="gbab-609"></a><span class="cp">  FT_Init_Class_ ## script_class( AF_ScriptClassRec*  ac )                 \</span>
<a name="gbab-610"></a><span class="cp">  {                                                                        \</span>
<a name="gbab-611"></a><span class="cp">    ac-&gt;script               = script_;                                    \</span>
<a name="gbab-612"></a><span class="cp">    ac-&gt;script_uni_ranges    = ranges;                                     \</span>
<a name="gbab-613"></a><span class="cp">    ac-&gt;script_uni_nonbase_ranges = nonbase_ranges;        \</span>
<a name="gbab-614"></a><span class="cp">    ac-&gt;top_to_bottom_hinting     = top_to_bottom;         \</span>
<a name="gbab-615"></a><span class="cp">    ac-&gt;standard_charstring       = std_charstring;        \</span>
<a name="gbab-616"></a><span class="cp">  }</span>
<a name="gbab-617"></a>
<a name="gbab-618"></a>
<a name="gbab-619"></a><span class="cp">#define AF_DECLARE_STYLE_CLASS( style_class )             \</span>
<a name="gbab-620"></a><span class="cp">  FT_LOCAL( void )                                        \</span>
<a name="gbab-621"></a><span class="cp">  FT_Init_Class_ ## style_class( AF_StyleClassRec*  ac );</span>
<a name="gbab-622"></a>
<a name="gbab-623"></a><span class="cp">#define AF_DEFINE_STYLE_CLASS(                           \</span>
<a name="gbab-624"></a><span class="cp">          style_class,                                   \</span>
<a name="gbab-625"></a><span class="cp">          style_,                                        \</span>
<a name="gbab-626"></a><span class="cp">          writing_system_,                               \</span>
<a name="gbab-627"></a><span class="cp">          script_,                                       \</span>
<a name="gbab-628"></a><span class="cp">          blue_stringset_,                               \</span>
<a name="gbab-629"></a><span class="cp">          coverage_ )                                    \</span>
<a name="gbab-630"></a><span class="cp">  FT_LOCAL_DEF( void )                                   \</span>
<a name="gbab-631"></a><span class="cp">  FT_Init_Class_ ## style_class( AF_StyleClassRec*  ac ) \</span>
<a name="gbab-632"></a><span class="cp">  {                                                      \</span>
<a name="gbab-633"></a><span class="cp">    ac-&gt;style          = style_;                         \</span>
<a name="gbab-634"></a><span class="cp">    ac-&gt;writing_system = writing_system_;                \</span>
<a name="gbab-635"></a><span class="cp">    ac-&gt;script         = script_;                        \</span>
<a name="gbab-636"></a><span class="cp">    ac-&gt;blue_stringset = blue_stringset_;                \</span>
<a name="gbab-637"></a><span class="cp">    ac-&gt;coverage       = coverage_;                      \</span>
<a name="gbab-638"></a><span class="cp">  }</span>
<a name="gbab-639"></a>
<a name="gbab-640"></a><span class="cp">#endif </span><span class="cm">/* FT_CONFIG_OPTION_PIC */</span><span class="cp"></span>
<a name="gbab-641"></a>
<a name="gbab-642"></a>
<a name="gbab-643"></a><span class="cm">/* */</span>
<a name="gbab-644"></a>
<a name="gbab-645"></a><span class="n">FT_END_HEADER</span>
<a name="gbab-646"></a>
<a name="gbab-647"></a><span class="cp">#endif </span><span class="cm">/* AFTYPES_H_ */</span><span class="cp"></span>
<a name="gbab-648"></a>
<a name="gbab-649"></a>
<a name="gbab-650"></a><span class="cm">/* END */</span>
</pre></div>
</td></tr></table>