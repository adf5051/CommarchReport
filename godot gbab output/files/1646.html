<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="gbab-1"></a><span class="cm">/***************************************************************************/</span>
<a name="gbab-2"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-3"></a><span class="cm">/*  ttinterp.h                                                             */</span>
<a name="gbab-4"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-5"></a><span class="cm">/*    TrueType bytecode interpreter (specification).                       */</span>
<a name="gbab-6"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-7"></a><span class="cm">/*  Copyright 1996-2016 by                                                 */</span>
<a name="gbab-8"></a><span class="cm">/*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */</span>
<a name="gbab-9"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-10"></a><span class="cm">/*  This file is part of the FreeType project, and may only be used,       */</span>
<a name="gbab-11"></a><span class="cm">/*  modified, and distributed under the terms of the FreeType project      */</span>
<a name="gbab-12"></a><span class="cm">/*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */</span>
<a name="gbab-13"></a><span class="cm">/*  this file you indicate that you have read the license and              */</span>
<a name="gbab-14"></a><span class="cm">/*  understand and accept it fully.                                        */</span>
<a name="gbab-15"></a><span class="cm">/*                                                                         */</span>
<a name="gbab-16"></a><span class="cm">/***************************************************************************/</span>
<a name="gbab-17"></a>
<a name="gbab-18"></a>
<a name="gbab-19"></a><span class="cp">#ifndef TTINTERP_H_</span>
<a name="gbab-20"></a><span class="cp">#define TTINTERP_H_</span>
<a name="gbab-21"></a>
<a name="gbab-22"></a><span class="cp">#include</span> <span class="cpf">&lt;ft2build.h&gt;</span><span class="cp"></span>
<a name="gbab-23"></a><span class="cp">#include</span> <span class="cpf">&quot;ttobjs.h&quot;</span><span class="cp"></span>
<a name="gbab-24"></a>
<a name="gbab-25"></a>
<a name="gbab-26"></a><span class="n">FT_BEGIN_HEADER</span>
<a name="gbab-27"></a>
<a name="gbab-28"></a>
<a name="gbab-29"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-30"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-31"></a>  <span class="cm">/* Rounding mode constants.                                              */</span>
<a name="gbab-32"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-33"></a><span class="cp">#define TT_Round_Off             5</span>
<a name="gbab-34"></a><span class="cp">#define TT_Round_To_Half_Grid    0</span>
<a name="gbab-35"></a><span class="cp">#define TT_Round_To_Grid         1</span>
<a name="gbab-36"></a><span class="cp">#define TT_Round_To_Double_Grid  2</span>
<a name="gbab-37"></a><span class="cp">#define TT_Round_Up_To_Grid      4</span>
<a name="gbab-38"></a><span class="cp">#define TT_Round_Down_To_Grid    3</span>
<a name="gbab-39"></a><span class="cp">#define TT_Round_Super           6</span>
<a name="gbab-40"></a><span class="cp">#define TT_Round_Super_45        7</span>
<a name="gbab-41"></a>
<a name="gbab-42"></a>
<a name="gbab-43"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-44"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-45"></a>  <span class="cm">/* Function types used by the interpreter, depending on various modes    */</span>
<a name="gbab-46"></a>  <span class="cm">/* (e.g. the rounding mode, whether to render a vertical or horizontal   */</span>
<a name="gbab-47"></a>  <span class="cm">/* line etc).                                                            */</span>
<a name="gbab-48"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-49"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-50"></a>
<a name="gbab-51"></a>  <span class="cm">/* Rounding function */</span>
<a name="gbab-52"></a>  <span class="k">typedef</span> <span class="n">FT_F26Dot6</span>
<a name="gbab-53"></a>  <span class="p">(</span><span class="o">*</span><span class="n">TT_Round_Func</span><span class="p">)(</span> <span class="n">TT_ExecContext</span>  <span class="n">exc</span><span class="p">,</span>
<a name="gbab-54"></a>                    <span class="n">FT_F26Dot6</span>      <span class="n">distance</span><span class="p">,</span>
<a name="gbab-55"></a>                             <span class="n">FT_F26Dot6</span>  <span class="n">compensation</span> <span class="p">);</span>
<a name="gbab-56"></a>
<a name="gbab-57"></a>  <span class="cm">/* Point displacement along the freedom vector routine */</span>
<a name="gbab-58"></a>  <span class="k">typedef</span> <span class="nf">void</span>
<a name="gbab-59"></a>  <span class="p">(</span><span class="o">*</span><span class="n">TT_Move_Func</span><span class="p">)(</span> <span class="n">TT_ExecContext</span>  <span class="n">exc</span><span class="p">,</span>
<a name="gbab-60"></a>                   <span class="n">TT_GlyphZone</span>    <span class="n">zone</span><span class="p">,</span>
<a name="gbab-61"></a>                            <span class="n">FT_UShort</span>     <span class="n">point</span><span class="p">,</span>
<a name="gbab-62"></a>                            <span class="n">FT_F26Dot6</span>    <span class="n">distance</span> <span class="p">);</span>
<a name="gbab-63"></a>
<a name="gbab-64"></a>  <span class="cm">/* Distance projection along one of the projection vectors */</span>
<a name="gbab-65"></a>  <span class="k">typedef</span> <span class="nf">FT_F26Dot6</span>
<a name="gbab-66"></a>  <span class="p">(</span><span class="o">*</span><span class="n">TT_Project_Func</span><span class="p">)(</span> <span class="n">TT_ExecContext</span>  <span class="n">exc</span><span class="p">,</span>
<a name="gbab-67"></a>                      <span class="n">FT_Pos</span>          <span class="n">dx</span><span class="p">,</span>
<a name="gbab-68"></a>                               <span class="n">FT_Pos</span>   <span class="n">dy</span> <span class="p">);</span>
<a name="gbab-69"></a>
<a name="gbab-70"></a>  <span class="cm">/* getting current ppem.  Take care of non-square pixels if necessary */</span>
<a name="gbab-71"></a>  <span class="k">typedef</span> <span class="nf">FT_Long</span>
<a name="gbab-72"></a>  <span class="p">(</span><span class="o">*</span><span class="n">TT_Cur_Ppem_Func</span><span class="p">)(</span> <span class="n">TT_ExecContext</span>  <span class="n">exc</span> <span class="p">);</span>
<a name="gbab-73"></a>
<a name="gbab-74"></a>  <span class="cm">/* reading a cvt value.  Take care of non-square pixels if necessary */</span>
<a name="gbab-75"></a>  <span class="k">typedef</span> <span class="nf">FT_F26Dot6</span>
<a name="gbab-76"></a>  <span class="p">(</span><span class="o">*</span><span class="n">TT_Get_CVT_Func</span><span class="p">)(</span> <span class="n">TT_ExecContext</span>  <span class="n">exc</span><span class="p">,</span>
<a name="gbab-77"></a>                      <span class="n">FT_ULong</span>        <span class="n">idx</span> <span class="p">);</span>
<a name="gbab-78"></a>
<a name="gbab-79"></a>  <span class="cm">/* setting or moving a cvt value.  Take care of non-square pixels  */</span>
<a name="gbab-80"></a>  <span class="cm">/* if necessary                                                    */</span>
<a name="gbab-81"></a>  <span class="k">typedef</span> <span class="nf">void</span>
<a name="gbab-82"></a>  <span class="p">(</span><span class="o">*</span><span class="n">TT_Set_CVT_Func</span><span class="p">)(</span> <span class="n">TT_ExecContext</span>  <span class="n">exc</span><span class="p">,</span>
<a name="gbab-83"></a>                      <span class="n">FT_ULong</span>        <span class="n">idx</span><span class="p">,</span>
<a name="gbab-84"></a>                               <span class="n">FT_F26Dot6</span>  <span class="n">value</span> <span class="p">);</span>
<a name="gbab-85"></a>
<a name="gbab-86"></a>
<a name="gbab-87"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-88"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-89"></a>  <span class="cm">/* This structure defines a call record, used to manage function calls.  */</span>
<a name="gbab-90"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-91"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">TT_CallRec_</span>
<a name="gbab-92"></a>  <span class="p">{</span>
<a name="gbab-93"></a>    <span class="n">FT_Int</span>   <span class="n">Caller_Range</span><span class="p">;</span>
<a name="gbab-94"></a>    <span class="n">FT_Long</span>  <span class="n">Caller_IP</span><span class="p">;</span>
<a name="gbab-95"></a>    <span class="n">FT_Long</span>  <span class="n">Cur_Count</span><span class="p">;</span>
<a name="gbab-96"></a>
<a name="gbab-97"></a>    <span class="n">TT_DefRecord</span>  <span class="o">*</span><span class="n">Def</span><span class="p">;</span> <span class="cm">/* either FDEF or IDEF */</span>
<a name="gbab-98"></a>
<a name="gbab-99"></a>  <span class="p">}</span> <span class="n">TT_CallRec</span><span class="p">,</span> <span class="o">*</span><span class="n">TT_CallStack</span><span class="p">;</span>
<a name="gbab-100"></a>
<a name="gbab-101"></a>
<a name="gbab-102"></a><span class="cp">#ifdef TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY</span>
<a name="gbab-103"></a>
<a name="gbab-104"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-105"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-106"></a>  <span class="cm">/* These structures define rules used to tweak subpixel hinting for      */</span>
<a name="gbab-107"></a>  <span class="cm">/* various fonts.  &quot;&quot;, 0, &quot;&quot;, NULL value indicates to match any value.   */</span>
<a name="gbab-108"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-109"></a>
<a name="gbab-110"></a><span class="cp">#define SPH_MAX_NAME_SIZE      32</span>
<a name="gbab-111"></a><span class="cp">#define SPH_MAX_CLASS_MEMBERS  100</span>
<a name="gbab-112"></a>
<a name="gbab-113"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">SPH_TweakRule_</span>
<a name="gbab-114"></a>  <span class="p">{</span>
<a name="gbab-115"></a>    <span class="k">const</span> <span class="kt">char</span>      <span class="n">family</span><span class="p">[</span><span class="n">SPH_MAX_NAME_SIZE</span><span class="p">];</span>
<a name="gbab-116"></a>    <span class="k">const</span> <span class="n">FT_UInt</span>   <span class="n">ppem</span><span class="p">;</span>
<a name="gbab-117"></a>    <span class="k">const</span> <span class="kt">char</span>      <span class="n">style</span><span class="p">[</span><span class="n">SPH_MAX_NAME_SIZE</span><span class="p">];</span>
<a name="gbab-118"></a>    <span class="k">const</span> <span class="n">FT_ULong</span>  <span class="n">glyph</span><span class="p">;</span>
<a name="gbab-119"></a>
<a name="gbab-120"></a>  <span class="p">}</span> <span class="n">SPH_TweakRule</span><span class="p">;</span>
<a name="gbab-121"></a>
<a name="gbab-122"></a>
<a name="gbab-123"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">SPH_ScaleRule_</span>
<a name="gbab-124"></a>  <span class="p">{</span>
<a name="gbab-125"></a>    <span class="k">const</span> <span class="kt">char</span>      <span class="n">family</span><span class="p">[</span><span class="n">SPH_MAX_NAME_SIZE</span><span class="p">];</span>
<a name="gbab-126"></a>    <span class="k">const</span> <span class="n">FT_UInt</span>   <span class="n">ppem</span><span class="p">;</span>
<a name="gbab-127"></a>    <span class="k">const</span> <span class="kt">char</span>      <span class="n">style</span><span class="p">[</span><span class="n">SPH_MAX_NAME_SIZE</span><span class="p">];</span>
<a name="gbab-128"></a>    <span class="k">const</span> <span class="n">FT_ULong</span>  <span class="n">glyph</span><span class="p">;</span>
<a name="gbab-129"></a>    <span class="k">const</span> <span class="n">FT_ULong</span>  <span class="n">scale</span><span class="p">;</span>
<a name="gbab-130"></a>
<a name="gbab-131"></a>  <span class="p">}</span> <span class="n">SPH_ScaleRule</span><span class="p">;</span>
<a name="gbab-132"></a>
<a name="gbab-133"></a>
<a name="gbab-134"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">SPH_Font_Class_</span>
<a name="gbab-135"></a>  <span class="p">{</span>
<a name="gbab-136"></a>    <span class="k">const</span> <span class="kt">char</span>  <span class="n">name</span><span class="p">[</span><span class="n">SPH_MAX_NAME_SIZE</span><span class="p">];</span>
<a name="gbab-137"></a>    <span class="k">const</span> <span class="kt">char</span>  <span class="n">member</span><span class="p">[</span><span class="n">SPH_MAX_CLASS_MEMBERS</span><span class="p">][</span><span class="n">SPH_MAX_NAME_SIZE</span><span class="p">];</span>
<a name="gbab-138"></a>
<a name="gbab-139"></a>  <span class="p">}</span> <span class="n">SPH_Font_Class</span><span class="p">;</span>
<a name="gbab-140"></a>
<a name="gbab-141"></a><span class="cp">#endif </span><span class="cm">/* TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY */</span><span class="cp"></span>
<a name="gbab-142"></a>
<a name="gbab-143"></a>
<a name="gbab-144"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-145"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-146"></a>  <span class="cm">/* The main structure for the interpreter which collects all necessary   */</span>
<a name="gbab-147"></a>  <span class="cm">/* variables and states.                                                 */</span>
<a name="gbab-148"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-149"></a>  <span class="k">typedef</span> <span class="k">struct</span>  <span class="n">TT_ExecContextRec_</span>
<a name="gbab-150"></a>  <span class="p">{</span>
<a name="gbab-151"></a>    <span class="n">TT_Face</span>            <span class="n">face</span><span class="p">;</span>
<a name="gbab-152"></a>    <span class="n">TT_Size</span>            <span class="n">size</span><span class="p">;</span>
<a name="gbab-153"></a>    <span class="n">FT_Memory</span>          <span class="n">memory</span><span class="p">;</span>
<a name="gbab-154"></a>
<a name="gbab-155"></a>    <span class="cm">/* instructions state */</span>
<a name="gbab-156"></a>
<a name="gbab-157"></a>    <span class="n">FT_Error</span>           <span class="n">error</span><span class="p">;</span>      <span class="cm">/* last execution error */</span>
<a name="gbab-158"></a>
<a name="gbab-159"></a>    <span class="n">FT_Long</span>            <span class="n">top</span><span class="p">;</span>        <span class="cm">/* top of exec. stack   */</span>
<a name="gbab-160"></a>
<a name="gbab-161"></a>    <span class="n">FT_Long</span>            <span class="n">stackSize</span><span class="p">;</span>  <span class="cm">/* size of exec. stack  */</span>
<a name="gbab-162"></a>    <span class="n">FT_Long</span><span class="o">*</span>           <span class="n">stack</span><span class="p">;</span>      <span class="cm">/* current exec. stack  */</span>
<a name="gbab-163"></a>
<a name="gbab-164"></a>    <span class="n">FT_Long</span>            <span class="n">args</span><span class="p">;</span>
<a name="gbab-165"></a>    <span class="n">FT_Long</span>            <span class="n">new_top</span><span class="p">;</span>    <span class="cm">/* new top after exec.  */</span>
<a name="gbab-166"></a>
<a name="gbab-167"></a>    <span class="n">TT_GlyphZoneRec</span>    <span class="n">zp0</span><span class="p">,</span>        <span class="cm">/* zone records */</span>
<a name="gbab-168"></a>                       <span class="n">zp1</span><span class="p">,</span>
<a name="gbab-169"></a>                       <span class="n">zp2</span><span class="p">,</span>
<a name="gbab-170"></a>                       <span class="n">pts</span><span class="p">,</span>
<a name="gbab-171"></a>                       <span class="n">twilight</span><span class="p">;</span>
<a name="gbab-172"></a>
<a name="gbab-173"></a>    <span class="n">FT_Size_Metrics</span>    <span class="n">metrics</span><span class="p">;</span>
<a name="gbab-174"></a>    <span class="n">TT_Size_Metrics</span>    <span class="n">tt_metrics</span><span class="p">;</span> <span class="cm">/* size metrics */</span>
<a name="gbab-175"></a>
<a name="gbab-176"></a>    <span class="n">TT_GraphicsState</span>   <span class="n">GS</span><span class="p">;</span>         <span class="cm">/* current graphics state */</span>
<a name="gbab-177"></a>
<a name="gbab-178"></a>    <span class="n">FT_Int</span>             <span class="n">curRange</span><span class="p">;</span>  <span class="cm">/* current code range number   */</span>
<a name="gbab-179"></a>    <span class="n">FT_Byte</span><span class="o">*</span>           <span class="n">code</span><span class="p">;</span>      <span class="cm">/* current code range          */</span>
<a name="gbab-180"></a>    <span class="n">FT_Long</span>            <span class="n">IP</span><span class="p">;</span>        <span class="cm">/* current instruction pointer */</span>
<a name="gbab-181"></a>    <span class="n">FT_Long</span>            <span class="n">codeSize</span><span class="p">;</span>  <span class="cm">/* size of current range       */</span>
<a name="gbab-182"></a>
<a name="gbab-183"></a>    <span class="n">FT_Byte</span>            <span class="n">opcode</span><span class="p">;</span>    <span class="cm">/* current opcode              */</span>
<a name="gbab-184"></a>    <span class="n">FT_Int</span>             <span class="n">length</span><span class="p">;</span>    <span class="cm">/* length of current opcode    */</span>
<a name="gbab-185"></a>
<a name="gbab-186"></a>    <span class="n">FT_Bool</span>            <span class="n">step_ins</span><span class="p">;</span>  <span class="cm">/* true if the interpreter must */</span>
<a name="gbab-187"></a>                                  <span class="cm">/* increment IP after ins. exec */</span>
<a name="gbab-188"></a>    <span class="n">FT_ULong</span>           <span class="n">cvtSize</span><span class="p">;</span>
<a name="gbab-189"></a>    <span class="n">FT_Long</span><span class="o">*</span>           <span class="n">cvt</span><span class="p">;</span>
<a name="gbab-190"></a>
<a name="gbab-191"></a>    <span class="n">FT_UInt</span>            <span class="n">glyphSize</span><span class="p">;</span> <span class="cm">/* glyph instructions buffer size */</span>
<a name="gbab-192"></a>    <span class="n">FT_Byte</span><span class="o">*</span>           <span class="n">glyphIns</span><span class="p">;</span>  <span class="cm">/* glyph instructions buffer */</span>
<a name="gbab-193"></a>
<a name="gbab-194"></a>    <span class="n">FT_UInt</span>            <span class="n">numFDefs</span><span class="p">;</span>  <span class="cm">/* number of function defs         */</span>
<a name="gbab-195"></a>    <span class="n">FT_UInt</span>            <span class="n">maxFDefs</span><span class="p">;</span>  <span class="cm">/* maximum number of function defs */</span>
<a name="gbab-196"></a>    <span class="n">TT_DefArray</span>        <span class="n">FDefs</span><span class="p">;</span>     <span class="cm">/* table of FDefs entries          */</span>
<a name="gbab-197"></a>
<a name="gbab-198"></a>    <span class="n">FT_UInt</span>            <span class="n">numIDefs</span><span class="p">;</span>  <span class="cm">/* number of instruction defs */</span>
<a name="gbab-199"></a>    <span class="n">FT_UInt</span>            <span class="n">maxIDefs</span><span class="p">;</span>  <span class="cm">/* maximum number of ins defs */</span>
<a name="gbab-200"></a>    <span class="n">TT_DefArray</span>        <span class="n">IDefs</span><span class="p">;</span>     <span class="cm">/* table of IDefs entries     */</span>
<a name="gbab-201"></a>
<a name="gbab-202"></a>    <span class="n">FT_UInt</span>            <span class="n">maxFunc</span><span class="p">;</span>   <span class="cm">/* maximum function index     */</span>
<a name="gbab-203"></a>    <span class="n">FT_UInt</span>            <span class="n">maxIns</span><span class="p">;</span>    <span class="cm">/* maximum instruction index  */</span>
<a name="gbab-204"></a>
<a name="gbab-205"></a>    <span class="n">FT_Int</span>             <span class="n">callTop</span><span class="p">,</span>    <span class="cm">/* top of call stack during execution */</span>
<a name="gbab-206"></a>                       <span class="n">callSize</span><span class="p">;</span>   <span class="cm">/* size of call stack */</span>
<a name="gbab-207"></a>    <span class="n">TT_CallStack</span>       <span class="n">callStack</span><span class="p">;</span>  <span class="cm">/* call stack */</span>
<a name="gbab-208"></a>
<a name="gbab-209"></a>    <span class="n">FT_UShort</span>          <span class="n">maxPoints</span><span class="p">;</span>    <span class="cm">/* capacity of this context&#39;s `pts&#39; */</span>
<a name="gbab-210"></a>    <span class="n">FT_Short</span>           <span class="n">maxContours</span><span class="p">;</span>  <span class="cm">/* record, expressed in points and  */</span>
<a name="gbab-211"></a>                                     <span class="cm">/* contours.                        */</span>
<a name="gbab-212"></a>
<a name="gbab-213"></a>    <span class="n">TT_CodeRangeTable</span>  <span class="n">codeRangeTable</span><span class="p">;</span>  <span class="cm">/* table of valid code ranges */</span>
<a name="gbab-214"></a>                                        <span class="cm">/* useful for the debugger   */</span>
<a name="gbab-215"></a>
<a name="gbab-216"></a>    <span class="n">FT_UShort</span>          <span class="n">storeSize</span><span class="p">;</span>  <span class="cm">/* size of current storage */</span>
<a name="gbab-217"></a>    <span class="n">FT_Long</span><span class="o">*</span>           <span class="n">storage</span><span class="p">;</span>    <span class="cm">/* storage area            */</span>
<a name="gbab-218"></a>
<a name="gbab-219"></a>    <span class="n">FT_F26Dot6</span>         <span class="n">period</span><span class="p">;</span>     <span class="cm">/* values used for the */</span>
<a name="gbab-220"></a>    <span class="n">FT_F26Dot6</span>         <span class="n">phase</span><span class="p">;</span>      <span class="cm">/* `SuperRounding&#39;     */</span>
<a name="gbab-221"></a>    <span class="n">FT_F26Dot6</span>         <span class="n">threshold</span><span class="p">;</span>
<a name="gbab-222"></a>
<a name="gbab-223"></a>    <span class="n">FT_Bool</span>            <span class="n">instruction_trap</span><span class="p">;</span> <span class="cm">/* If `True&#39;, the interpreter will */</span>
<a name="gbab-224"></a>                                         <span class="cm">/* exit after each instruction     */</span>
<a name="gbab-225"></a>
<a name="gbab-226"></a>    <span class="n">TT_GraphicsState</span>   <span class="n">default_GS</span><span class="p">;</span>       <span class="cm">/* graphics state resulting from   */</span>
<a name="gbab-227"></a>                                         <span class="cm">/* the prep program                */</span>
<a name="gbab-228"></a>    <span class="n">FT_Bool</span>            <span class="n">is_composite</span><span class="p">;</span>     <span class="cm">/* true if the glyph is composite  */</span>
<a name="gbab-229"></a>    <span class="n">FT_Bool</span>            <span class="n">pedantic_hinting</span><span class="p">;</span> <span class="cm">/* true if pedantic interpretation */</span>
<a name="gbab-230"></a>
<a name="gbab-231"></a>    <span class="cm">/* latest interpreter additions */</span>
<a name="gbab-232"></a>
<a name="gbab-233"></a>    <span class="n">FT_Long</span>            <span class="n">F_dot_P</span><span class="p">;</span>    <span class="cm">/* dot product of freedom and projection */</span>
<a name="gbab-234"></a>                                   <span class="cm">/* vectors                               */</span>
<a name="gbab-235"></a>    <span class="n">TT_Round_Func</span>      <span class="n">func_round</span><span class="p">;</span> <span class="cm">/* current rounding function             */</span>
<a name="gbab-236"></a>
<a name="gbab-237"></a>    <span class="n">TT_Project_Func</span>    <span class="n">func_project</span><span class="p">,</span>   <span class="cm">/* current projection function */</span>
<a name="gbab-238"></a>                       <span class="n">func_dualproj</span><span class="p">,</span>  <span class="cm">/* current dual proj. function */</span>
<a name="gbab-239"></a>                       <span class="n">func_freeProj</span><span class="p">;</span>  <span class="cm">/* current freedom proj. func  */</span>
<a name="gbab-240"></a>
<a name="gbab-241"></a>    <span class="n">TT_Move_Func</span>       <span class="n">func_move</span><span class="p">;</span>      <span class="cm">/* current point move function */</span>
<a name="gbab-242"></a>    <span class="n">TT_Move_Func</span>       <span class="n">func_move_orig</span><span class="p">;</span> <span class="cm">/* move original position function */</span>
<a name="gbab-243"></a>
<a name="gbab-244"></a>    <span class="n">TT_Cur_Ppem_Func</span>   <span class="n">func_cur_ppem</span><span class="p">;</span>  <span class="cm">/* get current proj. ppem value  */</span>
<a name="gbab-245"></a>
<a name="gbab-246"></a>    <span class="n">TT_Get_CVT_Func</span>    <span class="n">func_read_cvt</span><span class="p">;</span>  <span class="cm">/* read a cvt entry              */</span>
<a name="gbab-247"></a>    <span class="n">TT_Set_CVT_Func</span>    <span class="n">func_write_cvt</span><span class="p">;</span> <span class="cm">/* write a cvt entry (in pixels) */</span>
<a name="gbab-248"></a>    <span class="n">TT_Set_CVT_Func</span>    <span class="n">func_move_cvt</span><span class="p">;</span>  <span class="cm">/* incr a cvt entry (in pixels)  */</span>
<a name="gbab-249"></a>
<a name="gbab-250"></a>    <span class="n">FT_Bool</span>            <span class="n">grayscale</span><span class="p">;</span>      <span class="cm">/* bi-level hinting and */</span>
<a name="gbab-251"></a>                                       <span class="cm">/* grayscale rendering  */</span>
<a name="gbab-252"></a>
<a name="gbab-253"></a><span class="cp">#ifdef TT_SUPPORT_SUBPIXEL_HINTING_MINIMAL</span>
<a name="gbab-254"></a>    <span class="cm">/*</span>
<a name="gbab-255"></a><span class="cm">     * Modern TrueType fonts are usually rendered through Microsoft&#39;s</span>
<a name="gbab-256"></a><span class="cm">     * collection of rendering techniques called ClearType (e.g., subpixel</span>
<a name="gbab-257"></a><span class="cm">     * rendering and subpixel hinting).  When ClearType was introduced, most</span>
<a name="gbab-258"></a><span class="cm">     * fonts were not ready.  Microsoft decided to implement a backwards</span>
<a name="gbab-259"></a><span class="cm">     * compatibility mode that employed several simple to complicated</span>
<a name="gbab-260"></a><span class="cm">     * assumptions and tricks that modified the interpretation of the</span>
<a name="gbab-261"></a><span class="cm">     * bytecode contained in these fonts to make them look ClearType-y</span>
<a name="gbab-262"></a><span class="cm">     * somehow.  Most (web)fonts that were released since then have come to</span>
<a name="gbab-263"></a><span class="cm">     * rely on these hacks to render correctly, even some of Microsoft&#39;s</span>
<a name="gbab-264"></a><span class="cm">     * flagship ClearType fonts (Calibri, Cambria, Segoe UI).</span>
<a name="gbab-265"></a><span class="cm">     *</span>
<a name="gbab-266"></a><span class="cm">     * The minimal subpixel hinting code (interpreter version 40) employs a</span>
<a name="gbab-267"></a><span class="cm">     * small list of font-agnostic hacks to bludgeon non-native-ClearType</span>
<a name="gbab-268"></a><span class="cm">     * fonts (except tricky ones[1]) into submission.  It will not try to</span>
<a name="gbab-269"></a><span class="cm">     * toggle hacks for specific fonts for performance and complexity</span>
<a name="gbab-270"></a><span class="cm">     * reasons.  The focus is on modern (web)fonts rather than legacy fonts</span>
<a name="gbab-271"></a><span class="cm">     * that were made for black-and-white rendering.</span>
<a name="gbab-272"></a><span class="cm">     *</span>
<a name="gbab-273"></a><span class="cm">     * Major hacks</span>
<a name="gbab-274"></a><span class="cm">     *</span>
<a name="gbab-275"></a><span class="cm">     * - Any point movement on the x axis is ignored (cf. `Direct_Move&#39; and</span>
<a name="gbab-276"></a><span class="cm">     *   `Direct_Move_X&#39;).  This has the smallest code footprint and single</span>
<a name="gbab-277"></a><span class="cm">     *   biggest effect.  The ClearType way to increase resolution is</span>
<a name="gbab-278"></a><span class="cm">     *   supersampling the x axis, the FreeType way is ignoring instructions</span>
<a name="gbab-279"></a><span class="cm">     *   on the x axis, which gives the same result in the majority of</span>
<a name="gbab-280"></a><span class="cm">     *   cases.</span>
<a name="gbab-281"></a><span class="cm">     *</span>
<a name="gbab-282"></a><span class="cm">     * - Points are not moved post-IUP (neither on the x nor on the y axis),</span>
<a name="gbab-283"></a><span class="cm">     *   except the x component of diagonal moves post-IUP (cf.</span>
<a name="gbab-284"></a><span class="cm">     *   `Direct_Move&#39;, `Direct_Move_Y&#39;, `Move_Zp2_Point&#39;).  Post-IUP</span>
<a name="gbab-285"></a><span class="cm">     *   changes are commonly used to `fix&#39; pixel patterns which has little</span>
<a name="gbab-286"></a><span class="cm">     *   use outside monochrome rendering.</span>
<a name="gbab-287"></a><span class="cm">     *</span>
<a name="gbab-288"></a><span class="cm">     * - SHPIX and DELTAP don&#39;t execute unless moving a composite on the</span>
<a name="gbab-289"></a><span class="cm">     *   y axis or moving a previously y touched point.  SHPIX additionally</span>
<a name="gbab-290"></a><span class="cm">     *   denies movement on the x axis (cf. `Ins_SHPIX&#39; and `Ins_DELTAP&#39;).</span>
<a name="gbab-291"></a><span class="cm">     *   Both instructions are commonly used to `fix&#39; pixel patterns for</span>
<a name="gbab-292"></a><span class="cm">     *   monochrome or Windows&#39;s GDI rendering but make little sense for</span>
<a name="gbab-293"></a><span class="cm">     *   FreeType rendering.  Both can distort the outline.  See [2] for</span>
<a name="gbab-294"></a><span class="cm">     *   details.</span>
<a name="gbab-295"></a><span class="cm">     *</span>
<a name="gbab-296"></a><span class="cm">     * - The hdmx table and modifications to phantom points are ignored.</span>
<a name="gbab-297"></a><span class="cm">     *   Bearings and advance widths remain unchanged (except rounding them</span>
<a name="gbab-298"></a><span class="cm">     *   outside the interpreter!), cf. `compute_glyph_metrics&#39; and</span>
<a name="gbab-299"></a><span class="cm">     *   `TT_Hint_Glyph&#39;.  Letting non-native-ClearType fonts modify spacing</span>
<a name="gbab-300"></a><span class="cm">     *   might mess up spacing.</span>
<a name="gbab-301"></a><span class="cm">     *</span>
<a name="gbab-302"></a><span class="cm">     * Minor hacks</span>
<a name="gbab-303"></a><span class="cm">     *</span>
<a name="gbab-304"></a><span class="cm">     * - FLIPRGON, FLIPRGOFF, and FLIPPT don&#39;t execute post-IUP.  This</span>
<a name="gbab-305"></a><span class="cm">     *   prevents dents in e.g. Arial-Regular&#39;s `D&#39; and `G&#39; glyphs at</span>
<a name="gbab-306"></a><span class="cm">     *   various sizes.</span>
<a name="gbab-307"></a><span class="cm">     *</span>
<a name="gbab-308"></a><span class="cm">     * (Post-IUP is the state after both IUP[x] and IUP[y] have been</span>
<a name="gbab-309"></a><span class="cm">     * executed.)</span>
<a name="gbab-310"></a><span class="cm">     *</span>
<a name="gbab-311"></a><span class="cm">     * The best results are achieved for fonts that were from the outset</span>
<a name="gbab-312"></a><span class="cm">     * designed with ClearType in mind, meaning they leave the x axis mostly</span>
<a name="gbab-313"></a><span class="cm">     * alone and don&#39;t mess with the `final&#39; outline to produce more</span>
<a name="gbab-314"></a><span class="cm">     * pleasing pixel patterns.  The harder the designer tried to produce</span>
<a name="gbab-315"></a><span class="cm">     * very specific patterns (`superhinting&#39;) for pre-ClearType-displays,</span>
<a name="gbab-316"></a><span class="cm">     * the worse the results.</span>
<a name="gbab-317"></a><span class="cm">     *</span>
<a name="gbab-318"></a><span class="cm">     * Microsoft defines a way to turn off backwards compatibility and</span>
<a name="gbab-319"></a><span class="cm">     * interpret instructions as before (called `native ClearType&#39;)[2][3].</span>
<a name="gbab-320"></a><span class="cm">     * The font designer then regains full control and is responsible for</span>
<a name="gbab-321"></a><span class="cm">     * making the font work correctly with ClearType without any</span>
<a name="gbab-322"></a><span class="cm">     * hand-holding by the interpreter or rasterizer[4].  The v40</span>
<a name="gbab-323"></a><span class="cm">     * interpreter assumes backwards compatibility by default, which can be</span>
<a name="gbab-324"></a><span class="cm">     * turned off the same way by executing the following in the control</span>
<a name="gbab-325"></a><span class="cm">     * program (cf. `Ins_INSTCTRL&#39;).</span>
<a name="gbab-326"></a><span class="cm">     *</span>
<a name="gbab-327"></a><span class="cm">     *   #PUSH 4,3</span>
<a name="gbab-328"></a><span class="cm">     *   INSTCTRL[]</span>
<a name="gbab-329"></a><span class="cm">     *</span>
<a name="gbab-330"></a><span class="cm">     * [1] Tricky fonts as FreeType defines them rely on the bytecode</span>
<a name="gbab-331"></a><span class="cm">     *     interpreter to display correctly.  Hacks can interfere with them,</span>
<a name="gbab-332"></a><span class="cm">     *     so they get treated like native ClearType fonts (v40 with</span>
<a name="gbab-333"></a><span class="cm">     *     backwards compatibility turned off).  Cf. `TT_RunIns&#39;.</span>
<a name="gbab-334"></a><span class="cm">     *</span>
<a name="gbab-335"></a><span class="cm">     * [2] Proposed by Microsoft&#39;s Greg Hitchcock in</span>
<a name="gbab-336"></a><span class="cm">     *     https://www.microsoft.com/typography/cleartype/truetypecleartype.aspx</span>
<a name="gbab-337"></a><span class="cm">     *</span>
<a name="gbab-338"></a><span class="cm">     * [3] Beat Stamm describes it in more detail:</span>
<a name="gbab-339"></a><span class="cm">     *     http://www.beatstamm.com/typography/RTRCh4.htm#Sec12</span>
<a name="gbab-340"></a><span class="cm">     *</span>
<a name="gbab-341"></a><span class="cm">     * [4] The list of `native ClearType&#39; fonts is small at the time of this</span>
<a name="gbab-342"></a><span class="cm">     *     writing; I found the following on a Windows 10 Update 1511</span>
<a name="gbab-343"></a><span class="cm">     *     installation: Constantia, Corbel, Sitka, Malgun Gothic, Microsoft</span>
<a name="gbab-344"></a><span class="cm">     *     JhengHei (Bold and UI Bold), Microsoft YaHei (Bold and UI Bold),</span>
<a name="gbab-345"></a><span class="cm">     *     SimSun, NSimSun, and Yu Gothic.</span>
<a name="gbab-346"></a><span class="cm">     *</span>
<a name="gbab-347"></a><span class="cm">     */</span>
<a name="gbab-348"></a>
<a name="gbab-349"></a>    <span class="cm">/* Using v40 implies subpixel hinting.  Used to detect interpreter */</span>
<a name="gbab-350"></a>    <span class="cm">/* version switches.  `_lean&#39; to differentiate from the Infinality */</span>
<a name="gbab-351"></a>    <span class="cm">/* `subpixel_hinting&#39;, which is managed differently.               */</span>
<a name="gbab-352"></a>    <span class="n">FT_Bool</span>            <span class="n">subpixel_hinting_lean</span><span class="p">;</span>
<a name="gbab-353"></a>
<a name="gbab-354"></a>    <span class="cm">/* Long side of a LCD subpixel is vertical (e.g., screen is rotated). */</span>
<a name="gbab-355"></a>    <span class="cm">/* `_lean&#39; to differentiate from the Infinality `vertical_lcd&#39;, which */</span>
<a name="gbab-356"></a>    <span class="cm">/* is managed differently.                                            */</span>
<a name="gbab-357"></a>    <span class="n">FT_Bool</span>            <span class="n">vertical_lcd_lean</span><span class="p">;</span>
<a name="gbab-358"></a>
<a name="gbab-359"></a>    <span class="cm">/* Default to backwards compatibility mode in v40 interpreter.  If  */</span>
<a name="gbab-360"></a>    <span class="cm">/* this is false, it implies the interpreter is in v35 or in native */</span>
<a name="gbab-361"></a>    <span class="cm">/* ClearType mode.                                                  */</span>
<a name="gbab-362"></a>    <span class="n">FT_Bool</span>            <span class="n">backwards_compatibility</span><span class="p">;</span>
<a name="gbab-363"></a>
<a name="gbab-364"></a>    <span class="cm">/* Useful for detecting and denying post-IUP trickery that is usually */</span>
<a name="gbab-365"></a>    <span class="cm">/* used to fix pixel patterns (`superhinting&#39;).                       */</span>
<a name="gbab-366"></a>    <span class="n">FT_Bool</span>            <span class="n">iupx_called</span><span class="p">;</span>
<a name="gbab-367"></a>    <span class="n">FT_Bool</span>            <span class="n">iupy_called</span><span class="p">;</span>
<a name="gbab-368"></a>
<a name="gbab-369"></a>    <span class="cm">/* ClearType hinting and grayscale rendering, as used by Universal */</span>
<a name="gbab-370"></a>    <span class="cm">/* Windows Platform apps (Windows 8 and above).  Like the standard */</span>
<a name="gbab-371"></a>    <span class="cm">/* colorful ClearType mode, it utilizes a vastly increased virtual */</span>
<a name="gbab-372"></a>    <span class="cm">/* resolution on the x axis.  Different from bi-level hinting and  */</span>
<a name="gbab-373"></a>    <span class="cm">/* grayscale rendering, the old mode from Win9x days that roughly  */</span>
<a name="gbab-374"></a>    <span class="cm">/* adheres to the physical pixel grid on both axes.                */</span>
<a name="gbab-375"></a>    <span class="n">FT_Bool</span>            <span class="n">grayscale_cleartype</span><span class="p">;</span>
<a name="gbab-376"></a><span class="cp">#endif </span><span class="cm">/* TT_SUPPORT_SUBPIXEL_HINTING_MINIMAL */</span><span class="cp"></span>
<a name="gbab-377"></a>
<a name="gbab-378"></a><span class="cp">#ifdef TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY</span>
<a name="gbab-379"></a>    <span class="n">TT_Round_Func</span>      <span class="n">func_round_sphn</span><span class="p">;</span>   <span class="cm">/* subpixel rounding function */</span>
<a name="gbab-380"></a>
<a name="gbab-381"></a>    <span class="n">FT_Bool</span>            <span class="n">subpixel_hinting</span><span class="p">;</span>  <span class="cm">/* Using subpixel hinting?       */</span>
<a name="gbab-382"></a>    <span class="n">FT_Bool</span>            <span class="n">ignore_x_mode</span><span class="p">;</span>     <span class="cm">/* Standard rendering mode for   */</span>
<a name="gbab-383"></a>                                          <span class="cm">/* subpixel hinting.  On if gray */</span>
<a name="gbab-384"></a>                                          <span class="cm">/* or subpixel hinting is on.    */</span>
<a name="gbab-385"></a>
<a name="gbab-386"></a>    <span class="cm">/* The following 6 aren&#39;t fully implemented but here for MS rasterizer */</span>
<a name="gbab-387"></a>    <span class="cm">/* compatibility.                                                      */</span>
<a name="gbab-388"></a>    <span class="n">FT_Bool</span>            <span class="n">compatible_widths</span><span class="p">;</span>     <span class="cm">/* compatible widths?        */</span>
<a name="gbab-389"></a>    <span class="n">FT_Bool</span>            <span class="n">symmetrical_smoothing</span><span class="p">;</span> <span class="cm">/* symmetrical_smoothing?    */</span>
<a name="gbab-390"></a>    <span class="n">FT_Bool</span>            <span class="n">bgr</span><span class="p">;</span>                   <span class="cm">/* bgr instead of rgb?       */</span>
<a name="gbab-391"></a>    <span class="n">FT_Bool</span>            <span class="n">vertical_lcd</span><span class="p">;</span>          <span class="cm">/* long side of LCD subpixel */</span>
<a name="gbab-392"></a>                                              <span class="cm">/* rectangles is horizontal  */</span>
<a name="gbab-393"></a>    <span class="n">FT_Bool</span>            <span class="n">subpixel_positioned</span><span class="p">;</span>   <span class="cm">/* subpixel positioned       */</span>
<a name="gbab-394"></a>                                              <span class="cm">/* (DirectWrite ClearType)?  */</span>
<a name="gbab-395"></a>    <span class="n">FT_Bool</span>            <span class="n">gray_cleartype</span><span class="p">;</span>        <span class="cm">/* ClearType hinting but     */</span>
<a name="gbab-396"></a>                                              <span class="cm">/* grayscale rendering       */</span>
<a name="gbab-397"></a>
<a name="gbab-398"></a>    <span class="n">FT_Int</span>             <span class="n">rasterizer_version</span><span class="p">;</span>    <span class="cm">/* MS rasterizer version     */</span>
<a name="gbab-399"></a>
<a name="gbab-400"></a>    <span class="n">FT_Bool</span>            <span class="n">iup_called</span><span class="p">;</span>            <span class="cm">/* IUP called for glyph?     */</span>
<a name="gbab-401"></a>
<a name="gbab-402"></a>    <span class="n">FT_ULong</span>           <span class="n">sph_tweak_flags</span><span class="p">;</span>       <span class="cm">/* flags to control          */</span>
<a name="gbab-403"></a>                                              <span class="cm">/* hint tweaks               */</span>
<a name="gbab-404"></a>
<a name="gbab-405"></a>    <span class="n">FT_ULong</span>           <span class="n">sph_in_func_flags</span><span class="p">;</span>     <span class="cm">/* flags to indicate if in   */</span>
<a name="gbab-406"></a>                                              <span class="cm">/* special functions         */</span>
<a name="gbab-407"></a>
<a name="gbab-408"></a><span class="cp">#endif </span><span class="cm">/* TT_SUPPORT_SUBPIXEL_HINTING_INFINALITY */</span><span class="cp"></span>
<a name="gbab-409"></a>
<a name="gbab-410"></a>  <span class="p">}</span> <span class="n">TT_ExecContextRec</span><span class="p">;</span>
<a name="gbab-411"></a>
<a name="gbab-412"></a>
<a name="gbab-413"></a>  <span class="k">extern</span> <span class="k">const</span> <span class="n">TT_GraphicsState</span>  <span class="n">tt_default_graphics_state</span><span class="p">;</span>
<a name="gbab-414"></a>
<a name="gbab-415"></a>
<a name="gbab-416"></a><span class="cp">#ifdef TT_USE_BYTECODE_INTERPRETER</span>
<a name="gbab-417"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
<a name="gbab-418"></a>  <span class="n">TT_Goto_CodeRange</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span><span class="p">,</span>
<a name="gbab-419"></a>                     <span class="n">FT_Int</span>          <span class="n">range</span><span class="p">,</span>
<a name="gbab-420"></a>                     <span class="n">FT_Long</span>         <span class="n">IP</span> <span class="p">);</span>
<a name="gbab-421"></a>
<a name="gbab-422"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
<a name="gbab-423"></a>  <span class="n">TT_Set_CodeRange</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span><span class="p">,</span>
<a name="gbab-424"></a>                    <span class="n">FT_Int</span>          <span class="n">range</span><span class="p">,</span>
<a name="gbab-425"></a>                    <span class="kt">void</span><span class="o">*</span>           <span class="n">base</span><span class="p">,</span>
<a name="gbab-426"></a>                    <span class="n">FT_Long</span>         <span class="n">length</span> <span class="p">);</span>
<a name="gbab-427"></a>
<a name="gbab-428"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
<a name="gbab-429"></a>  <span class="n">TT_Clear_CodeRange</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span><span class="p">,</span>
<a name="gbab-430"></a>                      <span class="n">FT_Int</span>          <span class="n">range</span> <span class="p">);</span>
<a name="gbab-431"></a>
<a name="gbab-432"></a>
<a name="gbab-433"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="n">FT_Error</span> <span class="p">)</span>
<a name="gbab-434"></a>  <span class="n">Update_Max</span><span class="p">(</span> <span class="n">FT_Memory</span>  <span class="n">memory</span><span class="p">,</span>
<a name="gbab-435"></a>              <span class="n">FT_ULong</span><span class="o">*</span>  <span class="n">size</span><span class="p">,</span>
<a name="gbab-436"></a>              <span class="n">FT_ULong</span>   <span class="n">multiplier</span><span class="p">,</span>
<a name="gbab-437"></a>              <span class="kt">void</span><span class="o">*</span>      <span class="n">_pbuff</span><span class="p">,</span>
<a name="gbab-438"></a>              <span class="n">FT_ULong</span>   <span class="n">new_max</span> <span class="p">);</span>
<a name="gbab-439"></a><span class="cp">#endif </span><span class="cm">/* TT_USE_BYTECODE_INTERPRETER */</span><span class="cp"></span>
<a name="gbab-440"></a>
<a name="gbab-441"></a>
<a name="gbab-442"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-443"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-444"></a>  <span class="cm">/* &lt;Function&gt;                                                            */</span>
<a name="gbab-445"></a>  <span class="cm">/*    TT_New_Context                                                     */</span>
<a name="gbab-446"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-447"></a>  <span class="cm">/* &lt;Description&gt;                                                         */</span>
<a name="gbab-448"></a>  <span class="cm">/*    Queries the face context for a given font.  Note that there is     */</span>
<a name="gbab-449"></a>  <span class="cm">/*    now a _single_ execution context in the TrueType driver which is   */</span>
<a name="gbab-450"></a>  <span class="cm">/*    shared among faces.                                                */</span>
<a name="gbab-451"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-452"></a>  <span class="cm">/* &lt;Input&gt;                                                               */</span>
<a name="gbab-453"></a>  <span class="cm">/*    face :: A handle to the source face object.                        */</span>
<a name="gbab-454"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-455"></a>  <span class="cm">/* &lt;Return&gt;                                                              */</span>
<a name="gbab-456"></a>  <span class="cm">/*    A handle to the execution context.  Initialized for `face&#39;.        */</span>
<a name="gbab-457"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-458"></a>  <span class="cm">/* &lt;Note&gt;                                                                */</span>
<a name="gbab-459"></a>  <span class="cm">/*    Only the glyph loader and debugger should call this function.      */</span>
<a name="gbab-460"></a>  <span class="cm">/*    (And right now only the glyph loader uses it.)                     */</span>
<a name="gbab-461"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-462"></a>  <span class="n">FT_EXPORT</span><span class="p">(</span> <span class="n">TT_ExecContext</span> <span class="p">)</span>
<a name="gbab-463"></a>  <span class="n">TT_New_Context</span><span class="p">(</span> <span class="n">TT_Driver</span>  <span class="n">driver</span> <span class="p">);</span>
<a name="gbab-464"></a>
<a name="gbab-465"></a>
<a name="gbab-466"></a><span class="cp">#ifdef TT_USE_BYTECODE_INTERPRETER</span>
<a name="gbab-467"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
<a name="gbab-468"></a>  <span class="n">TT_Done_Context</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span> <span class="p">);</span>
<a name="gbab-469"></a>
<a name="gbab-470"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="n">FT_Error</span> <span class="p">)</span>
<a name="gbab-471"></a>  <span class="n">TT_Load_Context</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span><span class="p">,</span>
<a name="gbab-472"></a>                   <span class="n">TT_Face</span>         <span class="n">face</span><span class="p">,</span>
<a name="gbab-473"></a>                   <span class="n">TT_Size</span>         <span class="n">size</span> <span class="p">);</span>
<a name="gbab-474"></a>
<a name="gbab-475"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span>
<a name="gbab-476"></a>  <span class="n">TT_Save_Context</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span><span class="p">,</span>
<a name="gbab-477"></a>                   <span class="n">TT_Size</span>         <span class="n">ins</span> <span class="p">);</span>
<a name="gbab-478"></a>
<a name="gbab-479"></a>  <span class="n">FT_LOCAL</span><span class="p">(</span> <span class="n">FT_Error</span> <span class="p">)</span>
<a name="gbab-480"></a>  <span class="n">TT_Run_Context</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span> <span class="p">);</span>
<a name="gbab-481"></a><span class="cp">#endif </span><span class="cm">/* TT_USE_BYTECODE_INTERPRETER */</span><span class="cp"></span>
<a name="gbab-482"></a>
<a name="gbab-483"></a>
<a name="gbab-484"></a>  <span class="cm">/*************************************************************************/</span>
<a name="gbab-485"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-486"></a>  <span class="cm">/* &lt;Function&gt;                                                            */</span>
<a name="gbab-487"></a>  <span class="cm">/*    TT_RunIns                                                          */</span>
<a name="gbab-488"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-489"></a>  <span class="cm">/* &lt;Description&gt;                                                         */</span>
<a name="gbab-490"></a>  <span class="cm">/*    Executes one or more instruction in the execution context.  This   */</span>
<a name="gbab-491"></a>  <span class="cm">/*    is the main function of the TrueType opcode interpreter.           */</span>
<a name="gbab-492"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-493"></a>  <span class="cm">/* &lt;Input&gt;                                                               */</span>
<a name="gbab-494"></a>  <span class="cm">/*    exec :: A handle to the target execution context.                  */</span>
<a name="gbab-495"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-496"></a>  <span class="cm">/* &lt;Return&gt;                                                              */</span>
<a name="gbab-497"></a>  <span class="cm">/*    FreeType error code.  0 means success.                             */</span>
<a name="gbab-498"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-499"></a>  <span class="cm">/* &lt;Note&gt;                                                                */</span>
<a name="gbab-500"></a>  <span class="cm">/*    Only the object manager and debugger should call this function.    */</span>
<a name="gbab-501"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-502"></a>  <span class="cm">/*    This function is publicly exported because it is directly          */</span>
<a name="gbab-503"></a>  <span class="cm">/*    invoked by the TrueType debugger.                                  */</span>
<a name="gbab-504"></a>  <span class="cm">/*                                                                       */</span>
<a name="gbab-505"></a>  <span class="n">FT_EXPORT</span><span class="p">(</span> <span class="n">FT_Error</span> <span class="p">)</span>
<a name="gbab-506"></a>  <span class="n">TT_RunIns</span><span class="p">(</span> <span class="n">TT_ExecContext</span>  <span class="n">exec</span> <span class="p">);</span>
<a name="gbab-507"></a>
<a name="gbab-508"></a>
<a name="gbab-509"></a><span class="n">FT_END_HEADER</span>
<a name="gbab-510"></a>
<a name="gbab-511"></a><span class="cp">#endif </span><span class="cm">/* TTINTERP_H_ */</span><span class="cp"></span>
<a name="gbab-512"></a>
<a name="gbab-513"></a>
<a name="gbab-514"></a><span class="cm">/* END */</span>
</pre></div>
</td></tr></table>