<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="gbab-1"></a><span class="cm">/* crypto/cms/cms.h */</span>
<a name="gbab-2"></a><span class="cm">/*</span>
<a name="gbab-3"></a><span class="cm"> * Written by Dr Stephen N Henson (steve@openssl.org) for the OpenSSL</span>
<a name="gbab-4"></a><span class="cm"> * project.</span>
<a name="gbab-5"></a><span class="cm"> */</span>
<a name="gbab-6"></a><span class="cm">/* ====================================================================</span>
<a name="gbab-7"></a><span class="cm"> * Copyright (c) 2008 The OpenSSL Project.  All rights reserved.</span>
<a name="gbab-8"></a><span class="cm"> *</span>
<a name="gbab-9"></a><span class="cm"> * Redistribution and use in source and binary forms, with or without</span>
<a name="gbab-10"></a><span class="cm"> * modification, are permitted provided that the following conditions</span>
<a name="gbab-11"></a><span class="cm"> * are met:</span>
<a name="gbab-12"></a><span class="cm"> *</span>
<a name="gbab-13"></a><span class="cm"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="gbab-14"></a><span class="cm"> *    notice, this list of conditions and the following disclaimer. </span>
<a name="gbab-15"></a><span class="cm"> *</span>
<a name="gbab-16"></a><span class="cm"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="gbab-17"></a><span class="cm"> *    notice, this list of conditions and the following disclaimer in</span>
<a name="gbab-18"></a><span class="cm"> *    the documentation and/or other materials provided with the</span>
<a name="gbab-19"></a><span class="cm"> *    distribution.</span>
<a name="gbab-20"></a><span class="cm"> *</span>
<a name="gbab-21"></a><span class="cm"> * 3. All advertising materials mentioning features or use of this</span>
<a name="gbab-22"></a><span class="cm"> *    software must display the following acknowledgment:</span>
<a name="gbab-23"></a><span class="cm"> *    &quot;This product includes software developed by the OpenSSL Project</span>
<a name="gbab-24"></a><span class="cm"> *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)&quot;</span>
<a name="gbab-25"></a><span class="cm"> *</span>
<a name="gbab-26"></a><span class="cm"> * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to</span>
<a name="gbab-27"></a><span class="cm"> *    endorse or promote products derived from this software without</span>
<a name="gbab-28"></a><span class="cm"> *    prior written permission. For written permission, please contact</span>
<a name="gbab-29"></a><span class="cm"> *    licensing@OpenSSL.org.</span>
<a name="gbab-30"></a><span class="cm"> *</span>
<a name="gbab-31"></a><span class="cm"> * 5. Products derived from this software may not be called &quot;OpenSSL&quot;</span>
<a name="gbab-32"></a><span class="cm"> *    nor may &quot;OpenSSL&quot; appear in their names without prior written</span>
<a name="gbab-33"></a><span class="cm"> *    permission of the OpenSSL Project.</span>
<a name="gbab-34"></a><span class="cm"> *</span>
<a name="gbab-35"></a><span class="cm"> * 6. Redistributions of any form whatsoever must retain the following</span>
<a name="gbab-36"></a><span class="cm"> *    acknowledgment:</span>
<a name="gbab-37"></a><span class="cm"> *    &quot;This product includes software developed by the OpenSSL Project</span>
<a name="gbab-38"></a><span class="cm"> *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)&quot;</span>
<a name="gbab-39"></a><span class="cm"> *</span>
<a name="gbab-40"></a><span class="cm"> * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS&#39;&#39; AND ANY</span>
<a name="gbab-41"></a><span class="cm"> * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<a name="gbab-42"></a><span class="cm"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</span>
<a name="gbab-43"></a><span class="cm"> * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR</span>
<a name="gbab-44"></a><span class="cm"> * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="gbab-45"></a><span class="cm"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span>
<a name="gbab-46"></a><span class="cm"> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="gbab-47"></a><span class="cm"> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<a name="gbab-48"></a><span class="cm"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span>
<a name="gbab-49"></a><span class="cm"> * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<a name="gbab-50"></a><span class="cm"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED</span>
<a name="gbab-51"></a><span class="cm"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="gbab-52"></a><span class="cm"> * ====================================================================</span>
<a name="gbab-53"></a><span class="cm"> */</span>
<a name="gbab-54"></a>
<a name="gbab-55"></a><span class="cp">#ifndef HEADER_CMS_H</span>
<a name="gbab-56"></a><span class="cp">#define HEADER_CMS_H</span>
<a name="gbab-57"></a>
<a name="gbab-58"></a><span class="cp">#include</span> <span class="cpf">&lt;openssl/x509.h&gt;</span><span class="cp"></span>
<a name="gbab-59"></a>
<a name="gbab-60"></a><span class="cp">#ifdef OPENSSL_NO_CMS</span>
<a name="gbab-61"></a><span class="cp">#error CMS is disabled.</span>
<a name="gbab-62"></a><span class="cp">#endif</span>
<a name="gbab-63"></a>
<a name="gbab-64"></a><span class="cp">#ifdef __cplusplus</span>
<a name="gbab-65"></a><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
<a name="gbab-66"></a><span class="cp">#endif</span>
<a name="gbab-67"></a>
<a name="gbab-68"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_ContentInfo_st</span> <span class="n">CMS_ContentInfo</span><span class="p">;</span>
<a name="gbab-69"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_SignerInfo_st</span> <span class="n">CMS_SignerInfo</span><span class="p">;</span>
<a name="gbab-70"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_CertificateChoices</span> <span class="n">CMS_CertificateChoices</span><span class="p">;</span>
<a name="gbab-71"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_RevocationInfoChoice_st</span> <span class="n">CMS_RevocationInfoChoice</span><span class="p">;</span>
<a name="gbab-72"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_RecipientInfo_st</span> <span class="n">CMS_RecipientInfo</span><span class="p">;</span>
<a name="gbab-73"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_ReceiptRequest_st</span> <span class="n">CMS_ReceiptRequest</span><span class="p">;</span>
<a name="gbab-74"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_Receipt_st</span> <span class="n">CMS_Receipt</span><span class="p">;</span>
<a name="gbab-75"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_RecipientEncryptedKey_st</span> <span class="n">CMS_RecipientEncryptedKey</span><span class="p">;</span>
<a name="gbab-76"></a><span class="k">typedef</span> <span class="k">struct</span> <span class="n">CMS_OtherKeyAttribute_st</span> <span class="n">CMS_OtherKeyAttribute</span><span class="p">;</span>
<a name="gbab-77"></a>
<a name="gbab-78"></a><span class="n">DECLARE_STACK_OF</span><span class="p">(</span><span class="n">CMS_SignerInfo</span><span class="p">)</span>
<a name="gbab-79"></a><span class="n">DECLARE_STACK_OF</span><span class="p">(</span><span class="n">GENERAL_NAMES</span><span class="p">)</span>
<a name="gbab-80"></a><span class="n">DECLARE_STACK_OF</span><span class="p">(</span><span class="n">CMS_RecipientEncryptedKey</span><span class="p">)</span>
<a name="gbab-81"></a><span class="n">DECLARE_ASN1_FUNCTIONS</span><span class="p">(</span><span class="n">CMS_ContentInfo</span><span class="p">)</span>
<a name="gbab-82"></a><span class="n">DECLARE_ASN1_FUNCTIONS</span><span class="p">(</span><span class="n">CMS_ReceiptRequest</span><span class="p">)</span>
<a name="gbab-83"></a><span class="n">DECLARE_ASN1_PRINT_FUNCTION</span><span class="p">(</span><span class="n">CMS_ContentInfo</span><span class="p">)</span>
<a name="gbab-84"></a>
<a name="gbab-85"></a><span class="cp">#define CMS_SIGNERINFO_ISSUER_SERIAL	0</span>
<a name="gbab-86"></a><span class="cp">#define CMS_SIGNERINFO_KEYIDENTIFIER	1</span>
<a name="gbab-87"></a>
<a name="gbab-88"></a><span class="cp"># define CMS_RECIPINFO_NONE              -1</span>
<a name="gbab-89"></a><span class="cp">#define CMS_RECIPINFO_TRANS		0</span>
<a name="gbab-90"></a><span class="cp">#define CMS_RECIPINFO_AGREE		1</span>
<a name="gbab-91"></a><span class="cp">#define CMS_RECIPINFO_KEK		2</span>
<a name="gbab-92"></a><span class="cp">#define CMS_RECIPINFO_PASS		3</span>
<a name="gbab-93"></a><span class="cp">#define CMS_RECIPINFO_OTHER		4</span>
<a name="gbab-94"></a>
<a name="gbab-95"></a><span class="cm">/* S/MIME related flags */</span>
<a name="gbab-96"></a>
<a name="gbab-97"></a><span class="cp">#define CMS_TEXT			0x1</span>
<a name="gbab-98"></a><span class="cp">#define CMS_NOCERTS			0x2</span>
<a name="gbab-99"></a><span class="cp">#define CMS_NO_CONTENT_VERIFY		0x4</span>
<a name="gbab-100"></a><span class="cp">#define CMS_NO_ATTR_VERIFY		0x8</span>
<a name="gbab-101"></a><span class="cp">#define CMS_NOSIGS			\</span>
<a name="gbab-102"></a><span class="cp">			(CMS_NO_CONTENT_VERIFY|CMS_NO_ATTR_VERIFY)</span>
<a name="gbab-103"></a><span class="cp">#define CMS_NOINTERN			0x10</span>
<a name="gbab-104"></a><span class="cp">#define CMS_NO_SIGNER_CERT_VERIFY	0x20</span>
<a name="gbab-105"></a><span class="cp">#define CMS_NOVERIFY			0x20</span>
<a name="gbab-106"></a><span class="cp">#define CMS_DETACHED			0x40</span>
<a name="gbab-107"></a><span class="cp">#define CMS_BINARY			0x80</span>
<a name="gbab-108"></a><span class="cp">#define CMS_NOATTR			0x100</span>
<a name="gbab-109"></a><span class="cp">#define	CMS_NOSMIMECAP			0x200</span>
<a name="gbab-110"></a><span class="cp">#define CMS_NOOLDMIMETYPE		0x400</span>
<a name="gbab-111"></a><span class="cp">#define CMS_CRLFEOL			0x800</span>
<a name="gbab-112"></a><span class="cp">#define CMS_STREAM			0x1000</span>
<a name="gbab-113"></a><span class="cp">#define CMS_NOCRL			0x2000</span>
<a name="gbab-114"></a><span class="cp">#define CMS_PARTIAL			0x4000</span>
<a name="gbab-115"></a><span class="cp">#define CMS_REUSE_DIGEST		0x8000</span>
<a name="gbab-116"></a><span class="cp">#define CMS_USE_KEYID			0x10000</span>
<a name="gbab-117"></a><span class="cp">#define CMS_DEBUG_DECRYPT		0x20000</span>
<a name="gbab-118"></a><span class="cp"># define CMS_KEY_PARAM                   0x40000</span>
<a name="gbab-119"></a>
<a name="gbab-120"></a><span class="k">const</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">CMS_get0_type</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-121"></a>
<a name="gbab-122"></a><span class="n">BIO</span> <span class="o">*</span><span class="nf">CMS_dataInit</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">icont</span><span class="p">);</span>
<a name="gbab-123"></a><span class="kt">int</span> <span class="nf">CMS_dataFinal</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">bio</span><span class="p">);</span>
<a name="gbab-124"></a>
<a name="gbab-125"></a><span class="n">ASN1_OCTET_STRING</span> <span class="o">**</span><span class="nf">CMS_get0_content</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-126"></a><span class="kt">int</span> <span class="nf">CMS_is_detached</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-127"></a><span class="kt">int</span> <span class="nf">CMS_set_detached</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="kt">int</span> <span class="n">detached</span><span class="p">);</span>
<a name="gbab-128"></a>
<a name="gbab-129"></a><span class="cp">#ifdef HEADER_PEM_H</span>
<a name="gbab-130"></a><span class="n">DECLARE_PEM_rw_const</span><span class="p">(</span><span class="n">CMS</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span><span class="p">)</span>
<a name="gbab-131"></a><span class="cp">#endif</span>
<a name="gbab-132"></a><span class="kt">int</span> <span class="n">CMS_stream</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">***</span><span class="n">boundary</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-133"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">d2i_CMS_bio</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">bp</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">**</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-134"></a><span class="kt">int</span> <span class="nf">i2d_CMS_bio</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">bp</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-135"></a>
<a name="gbab-136"></a><span class="n">BIO</span> <span class="o">*</span><span class="nf">BIO_new_CMS</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-137"></a><span class="kt">int</span> <span class="nf">i2d_CMS_bio_stream</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-138"></a><span class="kt">int</span> <span class="nf">PEM_write_bio_CMS_stream</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span>
<a name="gbab-139"></a>                             <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-140"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">SMIME_read_CMS</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">bio</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">**</span><span class="n">bcont</span><span class="p">);</span>
<a name="gbab-141"></a><span class="kt">int</span> <span class="nf">SMIME_write_CMS</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">bio</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-142"></a>
<a name="gbab-143"></a><span class="kt">int</span> <span class="nf">CMS_final</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">dcont</span><span class="p">,</span>
<a name="gbab-144"></a>              <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-145"></a>
<a name="gbab-146"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_sign</span><span class="p">(</span><span class="n">X509</span> <span class="o">*</span><span class="n">signcert</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">*</span><span class="n">pkey</span><span class="p">,</span>
<a name="gbab-147"></a>                          <span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">certs</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span>
<a name="gbab-148"></a>                          <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-149"></a>
<a name="gbab-150"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_sign_receipt</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-151"></a>					<span class="n">X509</span> <span class="o">*</span><span class="n">signcert</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">*</span><span class="n">pkey</span><span class="p">,</span>
<a name="gbab-152"></a>                                  <span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">certs</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-153"></a>
<a name="gbab-154"></a><span class="kt">int</span> <span class="nf">CMS_data</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-155"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_data_create</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-156"></a>
<a name="gbab-157"></a><span class="kt">int</span> <span class="nf">CMS_digest_verify</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">dcont</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span>
<a name="gbab-158"></a>							<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-159"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_digest_create</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="k">const</span> <span class="n">EVP_MD</span> <span class="o">*</span><span class="n">md</span><span class="p">,</span>
<a name="gbab-160"></a>							<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-161"></a>
<a name="gbab-162"></a><span class="kt">int</span> <span class="nf">CMS_EncryptedData_decrypt</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span>
<a name="gbab-163"></a>				<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">keylen</span><span class="p">,</span>
<a name="gbab-164"></a>				<span class="n">BIO</span> <span class="o">*</span><span class="n">dcont</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-165"></a>
<a name="gbab-166"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_EncryptedData_encrypt</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="k">const</span> <span class="n">EVP_CIPHER</span> <span class="o">*</span><span class="n">cipher</span><span class="p">,</span>
<a name="gbab-167"></a>                                           <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
<a name="gbab-168"></a>                                           <span class="kt">size_t</span> <span class="n">keylen</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-169"></a>
<a name="gbab-170"></a><span class="kt">int</span> <span class="nf">CMS_EncryptedData_set1_key</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="k">const</span> <span class="n">EVP_CIPHER</span> <span class="o">*</span><span class="n">ciph</span><span class="p">,</span>
<a name="gbab-171"></a>				<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">keylen</span><span class="p">);</span>
<a name="gbab-172"></a>
<a name="gbab-173"></a><span class="kt">int</span> <span class="nf">CMS_verify</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">certs</span><span class="p">,</span>
<a name="gbab-174"></a>		 <span class="n">X509_STORE</span> <span class="o">*</span><span class="n">store</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">dcont</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-175"></a>
<a name="gbab-176"></a><span class="kt">int</span> <span class="nf">CMS_verify_receipt</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">rcms</span><span class="p">,</span> <span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">ocms</span><span class="p">,</span>
<a name="gbab-177"></a>			<span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">certs</span><span class="p">,</span>
<a name="gbab-178"></a>			<span class="n">X509_STORE</span> <span class="o">*</span><span class="n">store</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-179"></a>
<a name="gbab-180"></a><span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">CMS_get0_signers</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-181"></a>
<a name="gbab-182"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_encrypt</span><span class="p">(</span><span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">certs</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span>
<a name="gbab-183"></a>				<span class="k">const</span> <span class="n">EVP_CIPHER</span> <span class="o">*</span><span class="n">cipher</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-184"></a>
<a name="gbab-185"></a><span class="kt">int</span> <span class="nf">CMS_decrypt</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">*</span><span class="n">pkey</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">,</span>
<a name="gbab-186"></a>                <span class="n">BIO</span> <span class="o">*</span><span class="n">dcont</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-187"></a>	
<a name="gbab-188"></a><span class="kt">int</span> <span class="nf">CMS_decrypt_set1_pkey</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">*</span><span class="n">pk</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">);</span>
<a name="gbab-189"></a><span class="kt">int</span> <span class="nf">CMS_decrypt_set1_key</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> 
<a name="gbab-190"></a>				<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">keylen</span><span class="p">,</span>
<a name="gbab-191"></a>				<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">idlen</span><span class="p">);</span>
<a name="gbab-192"></a><span class="kt">int</span> <span class="nf">CMS_decrypt_set1_password</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> 
<a name="gbab-193"></a>				<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pass</span><span class="p">,</span> <span class="n">ossl_ssize_t</span> <span class="n">passlen</span><span class="p">);</span>
<a name="gbab-194"></a>
<a name="gbab-195"></a><span class="n">STACK_OF</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span><span class="p">)</span> <span class="o">*</span><span class="n">CMS_get0_RecipientInfos</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-196"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_type</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">);</span>
<a name="gbab-197"></a><span class="n">EVP_PKEY_CTX</span> <span class="o">*</span><span class="nf">CMS_RecipientInfo_get0_pkey_ctx</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">);</span>
<a name="gbab-198"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_EnvelopedData_create</span><span class="p">(</span><span class="k">const</span> <span class="n">EVP_CIPHER</span> <span class="o">*</span><span class="n">cipher</span><span class="p">);</span>
<a name="gbab-199"></a><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="nf">CMS_add1_recipient_cert</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span>
<a name="gbab-200"></a>					<span class="n">X509</span> <span class="o">*</span><span class="n">recip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-201"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_set0_pkey</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">*</span><span class="n">pkey</span><span class="p">);</span>
<a name="gbab-202"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_ktri_cert_cmp</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">);</span>
<a name="gbab-203"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_ktri_get0_algs</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span>
<a name="gbab-204"></a>					<span class="n">EVP_PKEY</span> <span class="o">**</span><span class="n">pk</span><span class="p">,</span> <span class="n">X509</span> <span class="o">**</span><span class="n">recip</span><span class="p">,</span>
<a name="gbab-205"></a>					<span class="n">X509_ALGOR</span> <span class="o">**</span><span class="n">palg</span><span class="p">);</span>
<a name="gbab-206"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_ktri_get0_signer_id</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span>
<a name="gbab-207"></a>					<span class="n">ASN1_OCTET_STRING</span> <span class="o">**</span><span class="n">keyid</span><span class="p">,</span>
<a name="gbab-208"></a>                                          <span class="n">X509_NAME</span> <span class="o">**</span><span class="n">issuer</span><span class="p">,</span>
<a name="gbab-209"></a>                                          <span class="n">ASN1_INTEGER</span> <span class="o">**</span><span class="n">sno</span><span class="p">);</span>
<a name="gbab-210"></a>
<a name="gbab-211"></a><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="nf">CMS_add0_recipient_key</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nid</span><span class="p">,</span>
<a name="gbab-212"></a>					<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">keylen</span><span class="p">,</span>
<a name="gbab-213"></a>					<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">idlen</span><span class="p">,</span>
<a name="gbab-214"></a>					<span class="n">ASN1_GENERALIZEDTIME</span> <span class="o">*</span><span class="n">date</span><span class="p">,</span>
<a name="gbab-215"></a>					<span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">otherTypeId</span><span class="p">,</span>
<a name="gbab-216"></a>					<span class="n">ASN1_TYPE</span> <span class="o">*</span><span class="n">otherType</span><span class="p">);</span>
<a name="gbab-217"></a>
<a name="gbab-218"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_kekri_get0_id</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span>
<a name="gbab-219"></a>					<span class="n">X509_ALGOR</span> <span class="o">**</span><span class="n">palg</span><span class="p">,</span>
<a name="gbab-220"></a>					<span class="n">ASN1_OCTET_STRING</span> <span class="o">**</span><span class="n">pid</span><span class="p">,</span>
<a name="gbab-221"></a>					<span class="n">ASN1_GENERALIZEDTIME</span> <span class="o">**</span><span class="n">pdate</span><span class="p">,</span>
<a name="gbab-222"></a>					<span class="n">ASN1_OBJECT</span> <span class="o">**</span><span class="n">potherid</span><span class="p">,</span>
<a name="gbab-223"></a>					<span class="n">ASN1_TYPE</span> <span class="o">**</span><span class="n">pothertype</span><span class="p">);</span>
<a name="gbab-224"></a>
<a name="gbab-225"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_set0_key</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span> 
<a name="gbab-226"></a>				<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">keylen</span><span class="p">);</span>
<a name="gbab-227"></a>
<a name="gbab-228"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_kekri_id_cmp</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span> 
<a name="gbab-229"></a>					<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">idlen</span><span class="p">);</span>
<a name="gbab-230"></a>
<a name="gbab-231"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_set0_password</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span> 
<a name="gbab-232"></a>					<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pass</span><span class="p">,</span>
<a name="gbab-233"></a>					<span class="n">ossl_ssize_t</span> <span class="n">passlen</span><span class="p">);</span>
<a name="gbab-234"></a>
<a name="gbab-235"></a><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="nf">CMS_add0_recipient_password</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span>
<a name="gbab-236"></a>                                               <span class="kt">int</span> <span class="n">iter</span><span class="p">,</span> <span class="kt">int</span> <span class="n">wrap_nid</span><span class="p">,</span>
<a name="gbab-237"></a>                                               <span class="kt">int</span> <span class="n">pbe_nid</span><span class="p">,</span>
<a name="gbab-238"></a>					<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pass</span><span class="p">,</span>
<a name="gbab-239"></a>					<span class="n">ossl_ssize_t</span> <span class="n">passlen</span><span class="p">,</span>
<a name="gbab-240"></a>					<span class="k">const</span> <span class="n">EVP_CIPHER</span> <span class="o">*</span><span class="n">kekciph</span><span class="p">);</span>
<a name="gbab-241"></a>
<a name="gbab-242"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_decrypt</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">);</span>
<a name="gbab-243"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_encrypt</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">);</span>
<a name="gbab-244"></a>	
<a name="gbab-245"></a><span class="kt">int</span> <span class="nf">CMS_uncompress</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">dcont</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span>
<a name="gbab-246"></a>							<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-247"></a><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="nf">CMS_compress</span><span class="p">(</span><span class="n">BIO</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">int</span> <span class="n">comp_nid</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-248"></a>
<a name="gbab-249"></a><span class="kt">int</span> <span class="nf">CMS_set1_eContentType</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="k">const</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">oid</span><span class="p">);</span>
<a name="gbab-250"></a><span class="k">const</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="nf">CMS_get0_eContentType</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-251"></a>
<a name="gbab-252"></a><span class="n">CMS_CertificateChoices</span> <span class="o">*</span><span class="nf">CMS_add0_CertificateChoices</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-253"></a><span class="kt">int</span> <span class="nf">CMS_add0_cert</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">);</span>
<a name="gbab-254"></a><span class="kt">int</span> <span class="nf">CMS_add1_cert</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">);</span>
<a name="gbab-255"></a><span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">CMS_get1_certs</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-256"></a>
<a name="gbab-257"></a><span class="n">CMS_RevocationInfoChoice</span> <span class="o">*</span><span class="nf">CMS_add0_RevocationInfoChoice</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-258"></a><span class="kt">int</span> <span class="nf">CMS_add0_crl</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">X509_CRL</span> <span class="o">*</span><span class="n">crl</span><span class="p">);</span>
<a name="gbab-259"></a><span class="kt">int</span> <span class="nf">CMS_add1_crl</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">X509_CRL</span> <span class="o">*</span><span class="n">crl</span><span class="p">);</span>
<a name="gbab-260"></a><span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509_CRL</span><span class="p">)</span> <span class="o">*</span><span class="n">CMS_get1_crls</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-261"></a>
<a name="gbab-262"></a><span class="kt">int</span> <span class="nf">CMS_SignedData_init</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-263"></a><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="nf">CMS_add1_signer</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span>
<a name="gbab-264"></a>			<span class="n">X509</span> <span class="o">*</span><span class="n">signer</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">*</span><span class="n">pk</span><span class="p">,</span> <span class="k">const</span> <span class="n">EVP_MD</span> <span class="o">*</span><span class="n">md</span><span class="p">,</span>
<a name="gbab-265"></a>			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-266"></a><span class="n">EVP_PKEY_CTX</span> <span class="o">*</span><span class="nf">CMS_SignerInfo_get0_pkey_ctx</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
<a name="gbab-267"></a><span class="n">EVP_MD_CTX</span> <span class="o">*</span><span class="nf">CMS_SignerInfo_get0_md_ctx</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
<a name="gbab-268"></a><span class="n">STACK_OF</span><span class="p">(</span><span class="n">CMS_SignerInfo</span><span class="p">)</span> <span class="o">*</span><span class="n">CMS_get0_SignerInfos</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">);</span>
<a name="gbab-269"></a>
<a name="gbab-270"></a><span class="kt">void</span> <span class="nf">CMS_SignerInfo_set1_signer_cert</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">signer</span><span class="p">);</span>
<a name="gbab-271"></a><span class="kt">int</span> <span class="nf">CMS_SignerInfo_get0_signer_id</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-272"></a>					<span class="n">ASN1_OCTET_STRING</span> <span class="o">**</span><span class="n">keyid</span><span class="p">,</span>
<a name="gbab-273"></a>					<span class="n">X509_NAME</span> <span class="o">**</span><span class="n">issuer</span><span class="p">,</span> <span class="n">ASN1_INTEGER</span> <span class="o">**</span><span class="n">sno</span><span class="p">);</span>
<a name="gbab-274"></a><span class="kt">int</span> <span class="nf">CMS_SignerInfo_cert_cmp</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">);</span>
<a name="gbab-275"></a><span class="kt">int</span> <span class="nf">CMS_set1_signers_certs</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span> <span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509</span><span class="p">)</span> <span class="o">*</span><span class="n">certs</span><span class="p">,</span>
<a name="gbab-276"></a>					<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<a name="gbab-277"></a><span class="kt">void</span> <span class="nf">CMS_SignerInfo_get0_algs</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">**</span><span class="n">pk</span><span class="p">,</span>
<a name="gbab-278"></a>                              <span class="n">X509</span> <span class="o">**</span><span class="n">signer</span><span class="p">,</span> <span class="n">X509_ALGOR</span> <span class="o">**</span><span class="n">pdig</span><span class="p">,</span>
<a name="gbab-279"></a>                              <span class="n">X509_ALGOR</span> <span class="o">**</span><span class="n">psig</span><span class="p">);</span>
<a name="gbab-280"></a><span class="n">ASN1_OCTET_STRING</span> <span class="o">*</span><span class="nf">CMS_SignerInfo_get0_signature</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
<a name="gbab-281"></a><span class="kt">int</span> <span class="nf">CMS_SignerInfo_sign</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
<a name="gbab-282"></a><span class="kt">int</span> <span class="nf">CMS_SignerInfo_verify</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
<a name="gbab-283"></a><span class="kt">int</span> <span class="nf">CMS_SignerInfo_verify_content</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">BIO</span> <span class="o">*</span><span class="n">chain</span><span class="p">);</span>
<a name="gbab-284"></a>
<a name="gbab-285"></a><span class="kt">int</span> <span class="nf">CMS_add_smimecap</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509_ALGOR</span><span class="p">)</span> <span class="o">*</span><span class="n">algs</span><span class="p">);</span>
<a name="gbab-286"></a><span class="kt">int</span> <span class="nf">CMS_add_simple_smimecap</span><span class="p">(</span><span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509_ALGOR</span><span class="p">)</span> <span class="o">**</span><span class="n">algs</span><span class="p">,</span>
<a name="gbab-287"></a>				<span class="kt">int</span> <span class="n">algnid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">keysize</span><span class="p">);</span>
<a name="gbab-288"></a><span class="kt">int</span> <span class="nf">CMS_add_standard_smimecap</span><span class="p">(</span><span class="n">STACK_OF</span><span class="p">(</span><span class="n">X509_ALGOR</span><span class="p">)</span> <span class="o">**</span><span class="n">smcap</span><span class="p">);</span>
<a name="gbab-289"></a>
<a name="gbab-290"></a><span class="kt">int</span> <span class="nf">CMS_signed_get_attr_count</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
<a name="gbab-291"></a><span class="kt">int</span> <span class="nf">CMS_signed_get_attr_by_NID</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nid</span><span class="p">,</span>
<a name="gbab-292"></a>			  <span class="kt">int</span> <span class="n">lastpos</span><span class="p">);</span>
<a name="gbab-293"></a><span class="kt">int</span> <span class="nf">CMS_signed_get_attr_by_OBJ</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span>
<a name="gbab-294"></a>			  <span class="kt">int</span> <span class="n">lastpos</span><span class="p">);</span>
<a name="gbab-295"></a><span class="n">X509_ATTRIBUTE</span> <span class="o">*</span><span class="nf">CMS_signed_get_attr</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="kt">int</span> <span class="n">loc</span><span class="p">);</span>
<a name="gbab-296"></a><span class="n">X509_ATTRIBUTE</span> <span class="o">*</span><span class="nf">CMS_signed_delete_attr</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="kt">int</span> <span class="n">loc</span><span class="p">);</span>
<a name="gbab-297"></a><span class="kt">int</span> <span class="nf">CMS_signed_add1_attr</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">X509_ATTRIBUTE</span> <span class="o">*</span><span class="n">attr</span><span class="p">);</span>
<a name="gbab-298"></a><span class="kt">int</span> <span class="nf">CMS_signed_add1_attr_by_OBJ</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-299"></a>			<span class="k">const</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
<a name="gbab-300"></a>			<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<a name="gbab-301"></a><span class="kt">int</span> <span class="nf">CMS_signed_add1_attr_by_NID</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-302"></a>			<span class="kt">int</span> <span class="n">nid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
<a name="gbab-303"></a>			<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<a name="gbab-304"></a><span class="kt">int</span> <span class="nf">CMS_signed_add1_attr_by_txt</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-305"></a>			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">attrname</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
<a name="gbab-306"></a>			<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<a name="gbab-307"></a><span class="kt">void</span> <span class="o">*</span><span class="nf">CMS_signed_get0_data_by_OBJ</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">oid</span><span class="p">,</span>
<a name="gbab-308"></a>					<span class="kt">int</span> <span class="n">lastpos</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">);</span>
<a name="gbab-309"></a>
<a name="gbab-310"></a><span class="kt">int</span> <span class="nf">CMS_unsigned_get_attr_count</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">);</span>
<a name="gbab-311"></a><span class="kt">int</span> <span class="nf">CMS_unsigned_get_attr_by_NID</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nid</span><span class="p">,</span>
<a name="gbab-312"></a>			  <span class="kt">int</span> <span class="n">lastpos</span><span class="p">);</span>
<a name="gbab-313"></a><span class="kt">int</span> <span class="nf">CMS_unsigned_get_attr_by_OBJ</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span>
<a name="gbab-314"></a>			  <span class="kt">int</span> <span class="n">lastpos</span><span class="p">);</span>
<a name="gbab-315"></a><span class="n">X509_ATTRIBUTE</span> <span class="o">*</span><span class="nf">CMS_unsigned_get_attr</span><span class="p">(</span><span class="k">const</span> <span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="kt">int</span> <span class="n">loc</span><span class="p">);</span>
<a name="gbab-316"></a><span class="n">X509_ATTRIBUTE</span> <span class="o">*</span><span class="nf">CMS_unsigned_delete_attr</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="kt">int</span> <span class="n">loc</span><span class="p">);</span>
<a name="gbab-317"></a><span class="kt">int</span> <span class="nf">CMS_unsigned_add1_attr</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">X509_ATTRIBUTE</span> <span class="o">*</span><span class="n">attr</span><span class="p">);</span>
<a name="gbab-318"></a><span class="kt">int</span> <span class="nf">CMS_unsigned_add1_attr_by_OBJ</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-319"></a>			<span class="k">const</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
<a name="gbab-320"></a>			<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<a name="gbab-321"></a><span class="kt">int</span> <span class="nf">CMS_unsigned_add1_attr_by_NID</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-322"></a>			<span class="kt">int</span> <span class="n">nid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
<a name="gbab-323"></a>			<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<a name="gbab-324"></a><span class="kt">int</span> <span class="nf">CMS_unsigned_add1_attr_by_txt</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span>
<a name="gbab-325"></a>			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">attrname</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
<a name="gbab-326"></a>			<span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">);</span>
<a name="gbab-327"></a><span class="kt">void</span> <span class="o">*</span><span class="nf">CMS_unsigned_get0_data_by_OBJ</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">ASN1_OBJECT</span> <span class="o">*</span><span class="n">oid</span><span class="p">,</span>
<a name="gbab-328"></a>					<span class="kt">int</span> <span class="n">lastpos</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">);</span>
<a name="gbab-329"></a>
<a name="gbab-330"></a><span class="cp">#ifdef HEADER_X509V3_H</span>
<a name="gbab-331"></a>
<a name="gbab-332"></a><span class="kt">int</span> <span class="nf">CMS_get1_ReceiptRequest</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">CMS_ReceiptRequest</span> <span class="o">**</span><span class="n">prr</span><span class="p">);</span>
<a name="gbab-333"></a><span class="n">CMS_ReceiptRequest</span> <span class="o">*</span><span class="nf">CMS_ReceiptRequest_create0</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idlen</span><span class="p">,</span>
<a name="gbab-334"></a>				<span class="kt">int</span> <span class="n">allorfirst</span><span class="p">,</span>
<a name="gbab-335"></a>                                               <span class="n">STACK_OF</span><span class="p">(</span><span class="n">GENERAL_NAMES</span><span class="p">)</span>
<a name="gbab-336"></a>                                               <span class="o">*</span><span class="n">receiptList</span><span class="p">,</span> <span class="n">STACK_OF</span><span class="p">(</span><span class="n">GENERAL_NAMES</span><span class="p">)</span>
<a name="gbab-337"></a>                                               <span class="o">*</span><span class="n">receiptsTo</span><span class="p">);</span>
<a name="gbab-338"></a><span class="kt">int</span> <span class="nf">CMS_add1_ReceiptRequest</span><span class="p">(</span><span class="n">CMS_SignerInfo</span> <span class="o">*</span><span class="n">si</span><span class="p">,</span> <span class="n">CMS_ReceiptRequest</span> <span class="o">*</span><span class="n">rr</span><span class="p">);</span>
<a name="gbab-339"></a><span class="kt">void</span> <span class="nf">CMS_ReceiptRequest_get0_values</span><span class="p">(</span><span class="n">CMS_ReceiptRequest</span> <span class="o">*</span><span class="n">rr</span><span class="p">,</span>
<a name="gbab-340"></a>					<span class="n">ASN1_STRING</span> <span class="o">**</span><span class="n">pcid</span><span class="p">,</span>
<a name="gbab-341"></a>					<span class="kt">int</span> <span class="o">*</span><span class="n">pallorfirst</span><span class="p">,</span>
<a name="gbab-342"></a>					<span class="n">STACK_OF</span><span class="p">(</span><span class="n">GENERAL_NAMES</span><span class="p">)</span> <span class="o">**</span><span class="n">plist</span><span class="p">,</span>
<a name="gbab-343"></a>					<span class="n">STACK_OF</span><span class="p">(</span><span class="n">GENERAL_NAMES</span><span class="p">)</span> <span class="o">**</span><span class="n">prto</span><span class="p">);</span>
<a name="gbab-344"></a><span class="cp">#endif</span>
<a name="gbab-345"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_kari_get0_alg</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span>
<a name="gbab-346"></a>                                    <span class="n">X509_ALGOR</span> <span class="o">**</span><span class="n">palg</span><span class="p">,</span>
<a name="gbab-347"></a>                                    <span class="n">ASN1_OCTET_STRING</span> <span class="o">**</span><span class="n">pukm</span><span class="p">);</span>
<a name="gbab-348"></a><span class="n">STACK_OF</span><span class="p">(</span><span class="n">CMS_RecipientEncryptedKey</span><span class="p">)</span>
<a name="gbab-349"></a><span class="o">*</span><span class="n">CMS_RecipientInfo_kari_get0_reks</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">);</span>
<a name="gbab-350"></a>
<a name="gbab-351"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_kari_get0_orig_id</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span>
<a name="gbab-352"></a>                                        <span class="n">X509_ALGOR</span> <span class="o">**</span><span class="n">pubalg</span><span class="p">,</span>
<a name="gbab-353"></a>                                        <span class="n">ASN1_BIT_STRING</span> <span class="o">**</span><span class="n">pubkey</span><span class="p">,</span>
<a name="gbab-354"></a>                                        <span class="n">ASN1_OCTET_STRING</span> <span class="o">**</span><span class="n">keyid</span><span class="p">,</span>
<a name="gbab-355"></a>                                        <span class="n">X509_NAME</span> <span class="o">**</span><span class="n">issuer</span><span class="p">,</span>
<a name="gbab-356"></a>                                        <span class="n">ASN1_INTEGER</span> <span class="o">**</span><span class="n">sno</span><span class="p">);</span>
<a name="gbab-357"></a>
<a name="gbab-358"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_kari_orig_id_cmp</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span> <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">);</span>
<a name="gbab-359"></a>
<a name="gbab-360"></a><span class="kt">int</span> <span class="nf">CMS_RecipientEncryptedKey_get0_id</span><span class="p">(</span><span class="n">CMS_RecipientEncryptedKey</span> <span class="o">*</span><span class="n">rek</span><span class="p">,</span>
<a name="gbab-361"></a>                                      <span class="n">ASN1_OCTET_STRING</span> <span class="o">**</span><span class="n">keyid</span><span class="p">,</span>
<a name="gbab-362"></a>                                      <span class="n">ASN1_GENERALIZEDTIME</span> <span class="o">**</span><span class="n">tm</span><span class="p">,</span>
<a name="gbab-363"></a>                                      <span class="n">CMS_OtherKeyAttribute</span> <span class="o">**</span><span class="n">other</span><span class="p">,</span>
<a name="gbab-364"></a>                                      <span class="n">X509_NAME</span> <span class="o">**</span><span class="n">issuer</span><span class="p">,</span> <span class="n">ASN1_INTEGER</span> <span class="o">**</span><span class="n">sno</span><span class="p">);</span>
<a name="gbab-365"></a><span class="kt">int</span> <span class="nf">CMS_RecipientEncryptedKey_cert_cmp</span><span class="p">(</span><span class="n">CMS_RecipientEncryptedKey</span> <span class="o">*</span><span class="n">rek</span><span class="p">,</span>
<a name="gbab-366"></a>                                       <span class="n">X509</span> <span class="o">*</span><span class="n">cert</span><span class="p">);</span>
<a name="gbab-367"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_kari_set0_pkey</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span> <span class="n">EVP_PKEY</span> <span class="o">*</span><span class="n">pk</span><span class="p">);</span>
<a name="gbab-368"></a><span class="n">EVP_CIPHER_CTX</span> <span class="o">*</span><span class="nf">CMS_RecipientInfo_kari_get0_ctx</span><span class="p">(</span><span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">);</span>
<a name="gbab-369"></a><span class="kt">int</span> <span class="nf">CMS_RecipientInfo_kari_decrypt</span><span class="p">(</span><span class="n">CMS_ContentInfo</span> <span class="o">*</span><span class="n">cms</span><span class="p">,</span>
<a name="gbab-370"></a>                                   <span class="n">CMS_RecipientInfo</span> <span class="o">*</span><span class="n">ri</span><span class="p">,</span>
<a name="gbab-371"></a>                                   <span class="n">CMS_RecipientEncryptedKey</span> <span class="o">*</span><span class="n">rek</span><span class="p">);</span>
<a name="gbab-372"></a>
<a name="gbab-373"></a><span class="kt">int</span> <span class="nf">CMS_SharedInfo_encode</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">**</span><span class="n">pder</span><span class="p">,</span> <span class="n">X509_ALGOR</span> <span class="o">*</span><span class="n">kekalg</span><span class="p">,</span>
<a name="gbab-374"></a>                          <span class="n">ASN1_OCTET_STRING</span> <span class="o">*</span><span class="n">ukm</span><span class="p">,</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
<a name="gbab-375"></a>
<a name="gbab-376"></a><span class="cm">/* BEGIN ERROR CODES */</span>
<a name="gbab-377"></a><span class="cm">/*</span>
<a name="gbab-378"></a><span class="cm"> * The following lines are auto generated by the script mkerr.pl. Any changes</span>
<a name="gbab-379"></a><span class="cm"> * made after this point may be overwritten when the script is next run.</span>
<a name="gbab-380"></a><span class="cm"> */</span>
<a name="gbab-381"></a><span class="kt">void</span> <span class="nf">ERR_load_CMS_strings</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<a name="gbab-382"></a>
<a name="gbab-383"></a><span class="cm">/* Error codes for the CMS functions. */</span>
<a name="gbab-384"></a>
<a name="gbab-385"></a><span class="cm">/* Function codes. */</span>
<a name="gbab-386"></a><span class="cp">#define CMS_F_CHECK_CONTENT				 99</span>
<a name="gbab-387"></a><span class="cp">#define CMS_F_CMS_ADD0_CERT				 164</span>
<a name="gbab-388"></a><span class="cp">#define CMS_F_CMS_ADD0_RECIPIENT_KEY			 100</span>
<a name="gbab-389"></a><span class="cp">#define CMS_F_CMS_ADD0_RECIPIENT_PASSWORD		 165</span>
<a name="gbab-390"></a><span class="cp">#define CMS_F_CMS_ADD1_RECEIPTREQUEST			 158</span>
<a name="gbab-391"></a><span class="cp">#define CMS_F_CMS_ADD1_RECIPIENT_CERT			 101</span>
<a name="gbab-392"></a><span class="cp">#define CMS_F_CMS_ADD1_SIGNER				 102</span>
<a name="gbab-393"></a><span class="cp">#define CMS_F_CMS_ADD1_SIGNINGTIME			 103</span>
<a name="gbab-394"></a><span class="cp">#define CMS_F_CMS_COMPRESS				 104</span>
<a name="gbab-395"></a><span class="cp">#define CMS_F_CMS_COMPRESSEDDATA_CREATE			 105</span>
<a name="gbab-396"></a><span class="cp">#define CMS_F_CMS_COMPRESSEDDATA_INIT_BIO		 106</span>
<a name="gbab-397"></a><span class="cp">#define CMS_F_CMS_COPY_CONTENT				 107</span>
<a name="gbab-398"></a><span class="cp">#define CMS_F_CMS_COPY_MESSAGEDIGEST			 108</span>
<a name="gbab-399"></a><span class="cp">#define CMS_F_CMS_DATA					 109</span>
<a name="gbab-400"></a><span class="cp">#define CMS_F_CMS_DATAFINAL				 110</span>
<a name="gbab-401"></a><span class="cp">#define CMS_F_CMS_DATAINIT				 111</span>
<a name="gbab-402"></a><span class="cp">#define CMS_F_CMS_DECRYPT				 112</span>
<a name="gbab-403"></a><span class="cp">#define CMS_F_CMS_DECRYPT_SET1_KEY			 113</span>
<a name="gbab-404"></a><span class="cp">#define CMS_F_CMS_DECRYPT_SET1_PASSWORD			 166</span>
<a name="gbab-405"></a><span class="cp">#define CMS_F_CMS_DECRYPT_SET1_PKEY			 114</span>
<a name="gbab-406"></a><span class="cp">#define CMS_F_CMS_DIGESTALGORITHM_FIND_CTX		 115</span>
<a name="gbab-407"></a><span class="cp">#define CMS_F_CMS_DIGESTALGORITHM_INIT_BIO		 116</span>
<a name="gbab-408"></a><span class="cp">#define CMS_F_CMS_DIGESTEDDATA_DO_FINAL			 117</span>
<a name="gbab-409"></a><span class="cp">#define CMS_F_CMS_DIGEST_VERIFY				 118</span>
<a name="gbab-410"></a><span class="cp">#define CMS_F_CMS_ENCODE_RECEIPT			 161</span>
<a name="gbab-411"></a><span class="cp">#define CMS_F_CMS_ENCRYPT				 119</span>
<a name="gbab-412"></a><span class="cp">#define CMS_F_CMS_ENCRYPTEDCONTENT_INIT_BIO		 120</span>
<a name="gbab-413"></a><span class="cp">#define CMS_F_CMS_ENCRYPTEDDATA_DECRYPT			 121</span>
<a name="gbab-414"></a><span class="cp">#define CMS_F_CMS_ENCRYPTEDDATA_ENCRYPT			 122</span>
<a name="gbab-415"></a><span class="cp">#define CMS_F_CMS_ENCRYPTEDDATA_SET1_KEY		 123</span>
<a name="gbab-416"></a><span class="cp">#define CMS_F_CMS_ENVELOPEDDATA_CREATE			 124</span>
<a name="gbab-417"></a><span class="cp">#define CMS_F_CMS_ENVELOPEDDATA_INIT_BIO		 125</span>
<a name="gbab-418"></a><span class="cp">#define CMS_F_CMS_ENVELOPED_DATA_INIT			 126</span>
<a name="gbab-419"></a><span class="cp"># define CMS_F_CMS_ENV_ASN1_CTRL                          171</span>
<a name="gbab-420"></a><span class="cp">#define CMS_F_CMS_FINAL					 127</span>
<a name="gbab-421"></a><span class="cp">#define CMS_F_CMS_GET0_CERTIFICATE_CHOICES		 128</span>
<a name="gbab-422"></a><span class="cp">#define CMS_F_CMS_GET0_CONTENT				 129</span>
<a name="gbab-423"></a><span class="cp">#define CMS_F_CMS_GET0_ECONTENT_TYPE			 130</span>
<a name="gbab-424"></a><span class="cp">#define CMS_F_CMS_GET0_ENVELOPED			 131</span>
<a name="gbab-425"></a><span class="cp">#define CMS_F_CMS_GET0_REVOCATION_CHOICES		 132</span>
<a name="gbab-426"></a><span class="cp">#define CMS_F_CMS_GET0_SIGNED				 133</span>
<a name="gbab-427"></a><span class="cp">#define CMS_F_CMS_MSGSIGDIGEST_ADD1			 162</span>
<a name="gbab-428"></a><span class="cp">#define CMS_F_CMS_RECEIPTREQUEST_CREATE0		 159</span>
<a name="gbab-429"></a><span class="cp">#define CMS_F_CMS_RECEIPT_VERIFY			 160</span>
<a name="gbab-430"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_DECRYPT			 134</span>
<a name="gbab-431"></a><span class="cp"># define CMS_F_CMS_RECIPIENTINFO_ENCRYPT                  169</span>
<a name="gbab-432"></a><span class="cp"># define CMS_F_CMS_RECIPIENTINFO_KARI_ENCRYPT             178</span>
<a name="gbab-433"></a><span class="cp"># define CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ALG            175</span>
<a name="gbab-434"></a><span class="cp"># define CMS_F_CMS_RECIPIENTINFO_KARI_GET0_ORIG_ID        173</span>
<a name="gbab-435"></a><span class="cp"># define CMS_F_CMS_RECIPIENTINFO_KARI_GET0_REKS           172</span>
<a name="gbab-436"></a><span class="cp"># define CMS_F_CMS_RECIPIENTINFO_KARI_ORIG_ID_CMP         174</span>
<a name="gbab-437"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_DECRYPT		 135</span>
<a name="gbab-438"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_ENCRYPT		 136</span>
<a name="gbab-439"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_GET0_ID		 137</span>
<a name="gbab-440"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KEKRI_ID_CMP		 138</span>
<a name="gbab-441"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KTRI_CERT_CMP		 139</span>
<a name="gbab-442"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KTRI_DECRYPT		 140</span>
<a name="gbab-443"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KTRI_ENCRYPT		 141</span>
<a name="gbab-444"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_ALGS		 142</span>
<a name="gbab-445"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_KTRI_GET0_SIGNER_ID	 143</span>
<a name="gbab-446"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_PWRI_CRYPT		 167</span>
<a name="gbab-447"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_SET0_KEY		 144</span>
<a name="gbab-448"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_SET0_PASSWORD		 168</span>
<a name="gbab-449"></a><span class="cp">#define CMS_F_CMS_RECIPIENTINFO_SET0_PKEY		 145</span>
<a name="gbab-450"></a><span class="cp"># define CMS_F_CMS_SD_ASN1_CTRL                           170</span>
<a name="gbab-451"></a><span class="cp"># define CMS_F_CMS_SET1_IAS                               176</span>
<a name="gbab-452"></a><span class="cp"># define CMS_F_CMS_SET1_KEYID                             177</span>
<a name="gbab-453"></a><span class="cp">#define CMS_F_CMS_SET1_SIGNERIDENTIFIER			 146</span>
<a name="gbab-454"></a><span class="cp">#define CMS_F_CMS_SET_DETACHED				 147</span>
<a name="gbab-455"></a><span class="cp">#define CMS_F_CMS_SIGN					 148</span>
<a name="gbab-456"></a><span class="cp">#define CMS_F_CMS_SIGNED_DATA_INIT			 149</span>
<a name="gbab-457"></a><span class="cp">#define CMS_F_CMS_SIGNERINFO_CONTENT_SIGN		 150</span>
<a name="gbab-458"></a><span class="cp">#define CMS_F_CMS_SIGNERINFO_SIGN			 151</span>
<a name="gbab-459"></a><span class="cp">#define CMS_F_CMS_SIGNERINFO_VERIFY			 152</span>
<a name="gbab-460"></a><span class="cp">#define CMS_F_CMS_SIGNERINFO_VERIFY_CERT		 153</span>
<a name="gbab-461"></a><span class="cp">#define CMS_F_CMS_SIGNERINFO_VERIFY_CONTENT		 154</span>
<a name="gbab-462"></a><span class="cp">#define CMS_F_CMS_SIGN_RECEIPT				 163</span>
<a name="gbab-463"></a><span class="cp">#define CMS_F_CMS_STREAM				 155</span>
<a name="gbab-464"></a><span class="cp">#define CMS_F_CMS_UNCOMPRESS				 156</span>
<a name="gbab-465"></a><span class="cp">#define CMS_F_CMS_VERIFY				 157</span>
<a name="gbab-466"></a>
<a name="gbab-467"></a><span class="cm">/* Reason codes. */</span>
<a name="gbab-468"></a><span class="cp">#define CMS_R_ADD_SIGNER_ERROR				 99</span>
<a name="gbab-469"></a><span class="cp">#define CMS_R_CERTIFICATE_ALREADY_PRESENT		 175</span>
<a name="gbab-470"></a><span class="cp">#define CMS_R_CERTIFICATE_HAS_NO_KEYID			 160</span>
<a name="gbab-471"></a><span class="cp">#define CMS_R_CERTIFICATE_VERIFY_ERROR			 100</span>
<a name="gbab-472"></a><span class="cp">#define CMS_R_CIPHER_INITIALISATION_ERROR		 101</span>
<a name="gbab-473"></a><span class="cp">#define CMS_R_CIPHER_PARAMETER_INITIALISATION_ERROR	 102</span>
<a name="gbab-474"></a><span class="cp">#define CMS_R_CMS_DATAFINAL_ERROR			 103</span>
<a name="gbab-475"></a><span class="cp">#define CMS_R_CMS_LIB					 104</span>
<a name="gbab-476"></a><span class="cp">#define CMS_R_CONTENTIDENTIFIER_MISMATCH		 170</span>
<a name="gbab-477"></a><span class="cp">#define CMS_R_CONTENT_NOT_FOUND				 105</span>
<a name="gbab-478"></a><span class="cp">#define CMS_R_CONTENT_TYPE_MISMATCH			 171</span>
<a name="gbab-479"></a><span class="cp">#define CMS_R_CONTENT_TYPE_NOT_COMPRESSED_DATA		 106</span>
<a name="gbab-480"></a><span class="cp">#define CMS_R_CONTENT_TYPE_NOT_ENVELOPED_DATA		 107</span>
<a name="gbab-481"></a><span class="cp">#define CMS_R_CONTENT_TYPE_NOT_SIGNED_DATA		 108</span>
<a name="gbab-482"></a><span class="cp">#define CMS_R_CONTENT_VERIFY_ERROR			 109</span>
<a name="gbab-483"></a><span class="cp">#define CMS_R_CTRL_ERROR				 110</span>
<a name="gbab-484"></a><span class="cp">#define CMS_R_CTRL_FAILURE				 111</span>
<a name="gbab-485"></a><span class="cp">#define CMS_R_DECRYPT_ERROR				 112</span>
<a name="gbab-486"></a><span class="cp">#define CMS_R_DIGEST_ERROR				 161</span>
<a name="gbab-487"></a><span class="cp">#define CMS_R_ERROR_GETTING_PUBLIC_KEY			 113</span>
<a name="gbab-488"></a><span class="cp">#define CMS_R_ERROR_READING_MESSAGEDIGEST_ATTRIBUTE	 114</span>
<a name="gbab-489"></a><span class="cp">#define CMS_R_ERROR_SETTING_KEY				 115</span>
<a name="gbab-490"></a><span class="cp">#define CMS_R_ERROR_SETTING_RECIPIENTINFO		 116</span>
<a name="gbab-491"></a><span class="cp">#define CMS_R_INVALID_ENCRYPTED_KEY_LENGTH		 117</span>
<a name="gbab-492"></a><span class="cp">#define CMS_R_INVALID_KEY_ENCRYPTION_PARAMETER		 176</span>
<a name="gbab-493"></a><span class="cp">#define CMS_R_INVALID_KEY_LENGTH			 118</span>
<a name="gbab-494"></a><span class="cp">#define CMS_R_MD_BIO_INIT_ERROR				 119</span>
<a name="gbab-495"></a><span class="cp">#define CMS_R_MESSAGEDIGEST_ATTRIBUTE_WRONG_LENGTH	 120</span>
<a name="gbab-496"></a><span class="cp">#define CMS_R_MESSAGEDIGEST_WRONG_LENGTH		 121</span>
<a name="gbab-497"></a><span class="cp">#define CMS_R_MSGSIGDIGEST_ERROR			 172</span>
<a name="gbab-498"></a><span class="cp">#define CMS_R_MSGSIGDIGEST_VERIFICATION_FAILURE		 162</span>
<a name="gbab-499"></a><span class="cp">#define CMS_R_MSGSIGDIGEST_WRONG_LENGTH			 163</span>
<a name="gbab-500"></a><span class="cp">#define CMS_R_NEED_ONE_SIGNER				 164</span>
<a name="gbab-501"></a><span class="cp">#define CMS_R_NOT_A_SIGNED_RECEIPT			 165</span>
<a name="gbab-502"></a><span class="cp">#define CMS_R_NOT_ENCRYPTED_DATA			 122</span>
<a name="gbab-503"></a><span class="cp">#define CMS_R_NOT_KEK					 123</span>
<a name="gbab-504"></a><span class="cp"># define CMS_R_NOT_KEY_AGREEMENT                          181</span>
<a name="gbab-505"></a><span class="cp">#define CMS_R_NOT_KEY_TRANSPORT				 124</span>
<a name="gbab-506"></a><span class="cp">#define CMS_R_NOT_PWRI					 177</span>
<a name="gbab-507"></a><span class="cp">#define CMS_R_NOT_SUPPORTED_FOR_THIS_KEY_TYPE		 125</span>
<a name="gbab-508"></a><span class="cp">#define CMS_R_NO_CIPHER					 126</span>
<a name="gbab-509"></a><span class="cp">#define CMS_R_NO_CONTENT				 127</span>
<a name="gbab-510"></a><span class="cp">#define CMS_R_NO_CONTENT_TYPE				 173</span>
<a name="gbab-511"></a><span class="cp">#define CMS_R_NO_DEFAULT_DIGEST				 128</span>
<a name="gbab-512"></a><span class="cp">#define CMS_R_NO_DIGEST_SET				 129</span>
<a name="gbab-513"></a><span class="cp">#define CMS_R_NO_KEY					 130</span>
<a name="gbab-514"></a><span class="cp">#define CMS_R_NO_KEY_OR_CERT				 174</span>
<a name="gbab-515"></a><span class="cp">#define CMS_R_NO_MATCHING_DIGEST			 131</span>
<a name="gbab-516"></a><span class="cp">#define CMS_R_NO_MATCHING_RECIPIENT			 132</span>
<a name="gbab-517"></a><span class="cp">#define CMS_R_NO_MATCHING_SIGNATURE			 166</span>
<a name="gbab-518"></a><span class="cp">#define CMS_R_NO_MSGSIGDIGEST				 167</span>
<a name="gbab-519"></a><span class="cp">#define CMS_R_NO_PASSWORD				 178</span>
<a name="gbab-520"></a><span class="cp">#define CMS_R_NO_PRIVATE_KEY				 133</span>
<a name="gbab-521"></a><span class="cp">#define CMS_R_NO_PUBLIC_KEY				 134</span>
<a name="gbab-522"></a><span class="cp">#define CMS_R_NO_RECEIPT_REQUEST			 168</span>
<a name="gbab-523"></a><span class="cp">#define CMS_R_NO_SIGNERS				 135</span>
<a name="gbab-524"></a><span class="cp">#define CMS_R_PRIVATE_KEY_DOES_NOT_MATCH_CERTIFICATE	 136</span>
<a name="gbab-525"></a><span class="cp">#define CMS_R_RECEIPT_DECODE_ERROR			 169</span>
<a name="gbab-526"></a><span class="cp">#define CMS_R_RECIPIENT_ERROR				 137</span>
<a name="gbab-527"></a><span class="cp">#define CMS_R_SIGNER_CERTIFICATE_NOT_FOUND		 138</span>
<a name="gbab-528"></a><span class="cp">#define CMS_R_SIGNFINAL_ERROR				 139</span>
<a name="gbab-529"></a><span class="cp">#define CMS_R_SMIME_TEXT_ERROR				 140</span>
<a name="gbab-530"></a><span class="cp">#define CMS_R_STORE_INIT_ERROR				 141</span>
<a name="gbab-531"></a><span class="cp">#define CMS_R_TYPE_NOT_COMPRESSED_DATA			 142</span>
<a name="gbab-532"></a><span class="cp">#define CMS_R_TYPE_NOT_DATA				 143</span>
<a name="gbab-533"></a><span class="cp">#define CMS_R_TYPE_NOT_DIGESTED_DATA			 144</span>
<a name="gbab-534"></a><span class="cp">#define CMS_R_TYPE_NOT_ENCRYPTED_DATA			 145</span>
<a name="gbab-535"></a><span class="cp">#define CMS_R_TYPE_NOT_ENVELOPED_DATA			 146</span>
<a name="gbab-536"></a><span class="cp">#define CMS_R_UNABLE_TO_FINALIZE_CONTEXT		 147</span>
<a name="gbab-537"></a><span class="cp">#define CMS_R_UNKNOWN_CIPHER				 148</span>
<a name="gbab-538"></a><span class="cp">#define CMS_R_UNKNOWN_DIGEST_ALGORIHM			 149</span>
<a name="gbab-539"></a><span class="cp">#define CMS_R_UNKNOWN_ID				 150</span>
<a name="gbab-540"></a><span class="cp">#define CMS_R_UNSUPPORTED_COMPRESSION_ALGORITHM		 151</span>
<a name="gbab-541"></a><span class="cp">#define CMS_R_UNSUPPORTED_CONTENT_TYPE			 152</span>
<a name="gbab-542"></a><span class="cp">#define CMS_R_UNSUPPORTED_KEK_ALGORITHM			 153</span>
<a name="gbab-543"></a><span class="cp">#define CMS_R_UNSUPPORTED_KEY_ENCRYPTION_ALGORITHM	 179</span>
<a name="gbab-544"></a><span class="cp">#define CMS_R_UNSUPPORTED_RECIPIENT_TYPE		 154</span>
<a name="gbab-545"></a><span class="cp">#define CMS_R_UNSUPPORTED_RECPIENTINFO_TYPE		 155</span>
<a name="gbab-546"></a><span class="cp">#define CMS_R_UNSUPPORTED_TYPE				 156</span>
<a name="gbab-547"></a><span class="cp">#define CMS_R_UNWRAP_ERROR				 157</span>
<a name="gbab-548"></a><span class="cp">#define CMS_R_UNWRAP_FAILURE				 180</span>
<a name="gbab-549"></a><span class="cp">#define CMS_R_VERIFICATION_FAILURE			 158</span>
<a name="gbab-550"></a><span class="cp">#define CMS_R_WRAP_ERROR				 159</span>
<a name="gbab-551"></a>
<a name="gbab-552"></a><span class="cp">#ifdef  __cplusplus</span>
<a name="gbab-553"></a><span class="p">}</span>
<a name="gbab-554"></a><span class="cp">#endif</span>
<a name="gbab-555"></a><span class="cp">#endif</span>
</pre></div>
</td></tr></table>